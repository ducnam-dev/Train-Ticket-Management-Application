Index: src/dao/GaDao.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package dao;\n\nimport database.ConnectDB;\nimport entity.Ga;\n\nimport java.sql.*;\nimport java.util.Vector;\n\npublic class GaDao {\n\n\tpublic static Ga getGaById(String maGaDi) {\n\t\treturn null;\n\t}\n\tprivate static GaDao instance;\n\tpublic static GaDao getInstance() {\n        if (instance == null) {\n            // Đồng bộ hóa (synchronized) để đảm bảo an toàn đa luồng khi khởi tạo\n            synchronized (GaDao.class) {\n                if (instance == null) {\n                    // Tạo instance chỉ một lần\n                    instance = new GaDao();\n                }\n            }\n        }\n        return instance;\n    }\n\n\n    // Trong GaDao.java\n    public Vector<Ga> layDanhSachGa() {\n        Vector<Ga> danhSachGa = new Vector<>();\n        String sql = \"SELECT MaGa, TenGa, DiaChi FROM Ga\";\n\n        try (Connection con = ConnectDB.getInstance().getConnection(); // Khai báo trong try-with-resources\n             PreparedStatement pstmt = con.prepareStatement(sql);\n             ResultSet rs = pstmt.executeQuery()) { // Khai báo ResultSet trong try-with-resources\n\n            while (rs.next()) {\n                Ga ga = new Ga(rs.getString(\"MaGa\"), rs.getString(\"TenGa\"), rs.getString(\"DiaChi\"));\n                danhSachGa.add(ga);\n            }\n\n        } catch (SQLException e) {\n            System.err.println(\"Lỗi khi tải danh sách Ga: \" + e.getMessage());\n            e.printStackTrace();\n        }\n        return danhSachGa;\n    }\n\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/dao/GaDao.java b/src/dao/GaDao.java
--- a/src/dao/GaDao.java	(revision 9793dc6c8edd8e1d6bc907354e30a7993a07fe24)
+++ b/src/dao/GaDao.java	(date 1761492537656)
@@ -25,7 +25,6 @@
         return instance;
     }
 
-
     // Trong GaDao.java
     public Vector<Ga> layDanhSachGa() {
         Vector<Ga> danhSachGa = new Vector<>();
Index: src/gui/Panel/ManHinhBanVe.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package gui.Panel;\n\nimport dao.ChoDatDAO;\nimport dao.ChuyenTauDao;\nimport dao.GaDao;\nimport dao.ToaDAO;\nimport dao.GiaVeCoBanTheoGaDAO;\nimport dao.LoaiChoDatDAO;\nimport dao.LoaiVeDAO;\nimport dao.VeDAO;\nimport entity.*;\nimport gui.MainFrame.BanVeDashboard;\n\nimport javax.swing.*;\nimport javax.swing.border.EmptyBorder;\nimport javax.swing.border.TitledBorder;\nimport javax.swing.table.DefaultTableModel;\nimport java.awt.*;\nimport java.awt.event.ActionEvent;\nimport java.awt.event.ActionListener;\nimport java.awt.event.MouseEvent;\nimport java.awt.event.MouseListener;\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.*;\nimport java.util.List;\n\n/**\n * ManHinhBanVe - Phiên bản đã sắp xếp thành module để quan sát.\n * Bổ sung tính năng tính giá vé per-seat (dựa trên bảng GiaVeCoBanTheoGa,\n * hệ số LoaiChoDat và hệ số LoaiVe). Hiện các DAO mới là stub/mock để bạn triển khai DB.\n */\npublic class ManHinhBanVe extends JPanel implements MouseListener, ActionListener {\n\n    // ====================\n    // MODULE: Trạng thái & dữ liệu (State)\n    // ====================\n    private JPanel pnlToa;\n    private JPanel pnlSoDoGhe;\n    private JComboBox<Ga> cbGaDi;\n    private JComboBox<Ga> cbGaDen;\n    private JTextField dateField;\n\n    private JLabel lblTongSoKhach;\n    private JTextField txtNguoiCaoTuoi;\n    private JTextField txtNguoiLon;\n    private JTextField txtTreCon;\n    private JTextField txtSinhVien;\n\n    private JTable tableChuyenTau;\n    private DefaultTableModel tableModel;\n\n    private JPanel pnlDanhSachGheDaCho;\n\n    private Date date;\n    private List<ChuyenTau> ketQua = new ArrayList<>();\n    private String maChuyenTauHienTai = null;\n\n    private JButton lastSelectedToaButton = null;\n    private String maToaHienTai = null;\n\n    // Map tạm thời: MaChoDat -> TempKhachHang\n    private Map<String, ChiTietKhach> danhSachKhachHang = new LinkedHashMap<>();\n    // Map số lượng yêu cầu theo loại\n    private Map<String, Integer> soLuongYeuCau = new HashMap<>();\n\n    // Map toàn bộ ChoDat của toa hiện tại để tra cứu nhanh\n    private Map<String, ChoDat> tatCaChoDatToaHienTai = new HashMap<>();\n\n    // Danh sách ghế đang chọn: MaCho -> ChoDat\n    private Map<String, ChoDat> danhSachGheDaChon = new LinkedHashMap<>();\n\n    // Map nút ghế: MaCho -> JButton (để cập nhật trạng thái nút khi hủy chọn)\n    private Map<String, JButton> seatButtonsMap = new HashMap<>();\n\n    private static final SimpleDateFormat INPUT_DATE_FORMAT = new SimpleDateFormat(\"dd/MM/yyyy\");\n    private static final SimpleDateFormat SQL_DATE_FORMAT = new SimpleDateFormat(\"yyyy-MM-dd\");\n    private JScrollPane thongTinKhachScrollPane;\n\n    private static record ChiTietKhach(\n            ChoDat choDat,\n            String maLoaiVe,\n            String hoTen,\n            String cccd,\n            String sdt,\n            int tuoi\n    ) {\n        // PHƯƠNG THỨC HỖ TRỢ BẤT BIẾN (WITH)\n        // Dùng khi người dùng thay đổi loại vé\n        public ChiTietKhach withMaLoaiVe(String newMaLoaiVe) {\n            return new ChiTietKhach(this.choDat, newMaLoaiVe, this.hoTen, this.cccd, this.sdt, this.tuoi);\n        }\n\n        // Dùng khi người dùng thay đổi Họ tên\n        public ChiTietKhach withHoTen(String newHoTen) {\n            return new ChiTietKhach(this.choDat, this.maLoaiVe, newHoTen, this.cccd, this.sdt, this.tuoi);\n        }\n\n        // Dùng khi người dùng thay đổi CCCD\n        public ChiTietKhach withCccd(String newCccd) {\n            return new ChiTietKhach(this.choDat, this.maLoaiVe, this.hoTen, newCccd, this.sdt, this.tuoi);\n        }\n\n        // Dùng khi người dùng thay đổi SDT\n        public ChiTietKhach withSdt(String newSdt) {\n            return new ChiTietKhach(this.choDat, this.maLoaiVe, this.hoTen, this.cccd, newSdt, this.tuoi);\n        }\n\n        // Dùng khi người dùng thay đổi Tuổi\n        public ChiTietKhach withTuoi(int newTuoi) {\n            return new ChiTietKhach(this.choDat, this.maLoaiVe, this.hoTen, this.cccd, this.sdt, newTuoi);\n        }\n    }\n\n    // DAO\n    private ChoDatDAO choDatDao = new ChoDatDAO();\n    private GiaVeCoBanTheoGaDAO giaVeCoBanDAO = new GiaVeCoBanTheoGaDAO();\n    private LoaiChoDatDAO loaiChoDatDAO = new LoaiChoDatDAO();\n    private LoaiVeDAO loaiVeDAO = new LoaiVeDAO();\n    private VeDAO veDAO = new VeDAO();\n\n    // Mã loại vé (hằng)\n    private static final String MA_VE_NL = \"VT01\";\n    private static final String MA_VE_TE = \"VT02\";\n    private static final String MA_VE_NCT = \"VT03\";\n    private static final String MA_VE_SV = \"VT04\";\n    private JButton cancelButton, nextButton;\n    private JButton btnTimChuyen;\n\n    // Map lưu giá mỗi ghế (maCho -> giaVe đã làm tròn VNĐ)\n    private Map<String, Long> danhSachGiaVe = new HashMap<>();\n\n    // Label tổng tiền (phải là trường lớp để cập nhật)\n    private JLabel lblTotalPrice;\n    private JPanel loaiKhachSpinBoxPanel;\n    private JTextField txtTongSoKhach;\n    private JPanel pnlTongSoKhachControl;\n\n    // 1. Helper để cập nhật maLoaiVe (Dùng khi người dùng chọn ComboBox)\n\n    // 2. Helper chung để cập nhật bất kỳ trường nào (Dùng trong FocusListener)\n    private void updateKhachRecord(String maCho, String newValue, String fieldName) {\n        ChiTietKhach original = danhSachKhachHang.get(maCho);\n        if (original == null) return;\n\n        ChiTietKhach updated = switch (fieldName) {\n            case \"hoTen\" -> new ChiTietKhach(original.choDat(), original.maLoaiVe(), newValue, original.cccd(), original.sdt(), original.tuoi());\n            case \"cccd\" -> new ChiTietKhach(original.choDat(), original.maLoaiVe(), original.hoTen(), newValue, original.sdt(), original.tuoi());\n            case \"sdt\" -> new ChiTietKhach(original.choDat(), original.maLoaiVe(), original.hoTen(), original.cccd(), newValue, original.tuoi());\n            case \"tuoi\" -> new ChiTietKhach(original.choDat(), original.maLoaiVe(), original.hoTen(), original.cccd(), original.sdt(), parseTextFieldToInt(new JTextField(newValue)));\n            default -> original;\n        };\n        danhSachKhachHang.put(maCho, updated);\n    }\n\n    // ====================\n    // MODULE: Constructor + Layout chính\n    // ====================\n    public ManHinhBanVe() {\n        setLayout(new BorderLayout(5, 5));\n        setBorder(new EmptyBorder(10, 10, 10, 10));\n        setBackground(new Color(240, 242, 245));\n\n        add(taoPanelTieuDe(), BorderLayout.NORTH);\n        add(taoNoiDungChinh(), BorderLayout.CENTER);\n    }\n\n    // ====================\n    // MODULE: UI BUILDERS (các phương thức tạo vùng giao diện)\n    // ====================\n    private JPanel taoPanelTieuDe() {\n        JPanel panel = new JPanel(new BorderLayout());\n        panel.setBackground(Color.WHITE);\n        panel.setPreferredSize(new Dimension(0, 50));\n        panel.setBorder(new EmptyBorder(0, 10, 0, 10));\n\n        JLabel titleLabel = new JLabel(\"Bán vé\");\n        titleLabel.setFont(titleLabel.getFont().deriveFont(Font.BOLD, 24f));\n        panel.add(titleLabel, BorderLayout.WEST);\n\n        JLabel idLabel = new JLabel(\"ID: QL200001\");\n        panel.add(idLabel, BorderLayout.EAST);\n\n        return panel;\n    }\n\n    private JPanel taoNoiDungChinh() {\n        JPanel mainPanel = new JPanel(new BorderLayout(10, 0));\n        mainPanel.setBackground(Color.WHITE);\n\n        JPanel contentLeftPanel = new JPanel();\n        contentLeftPanel.setLayout(new BoxLayout(contentLeftPanel, BoxLayout.Y_AXIS));\n        contentLeftPanel.setOpaque(false);\n        contentLeftPanel.setBorder(new EmptyBorder(0, 0, 0, 5));\n\n        // Các khu vực con (được tách modular)\n        contentLeftPanel.add(createKhuVucTimKiem());\n        contentLeftPanel.add(Box.createVerticalStrut(10));\n        contentLeftPanel.add(createKhuVucDanhSachChuyenTau());\n        contentLeftPanel.add(Box.createVerticalStrut(10));\n        contentLeftPanel.add(createKhuVucChonLoaiKhach());\n        contentLeftPanel.add(Box.createVerticalStrut(10));\n        contentLeftPanel.add(createKhuVucChonViTriGhe());\n        contentLeftPanel.add(Box.createVerticalStrut(10));\n\n        contentLeftPanel.add(Box.createVerticalGlue());\n\n        JScrollPane leftScrollPane = new JScrollPane(contentLeftPanel);\n        leftScrollPane.setBorder(null);\n        leftScrollPane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);\n        leftScrollPane.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED);\n        leftScrollPane.getVerticalScrollBar().setUnitIncrement(16);\n\n        JPanel leftContainer = new JPanel(new BorderLayout());\n        leftContainer.setOpaque(true);\n        leftContainer.add(leftScrollPane, BorderLayout.CENTER);\n\n        JPanel rightPanel = createKhuVucThongTinKhach();\n//        rightPanel.add(createKhuVucTongTien(), BorderLayout.SOUTH);\n        JSplitPane split = new JSplitPane(JSplitPane.HORIZONTAL_SPLIT, leftContainer, rightPanel);\n        split.setResizeWeight(0.75);\n        split.setOneTouchExpandable(true);\n        split.setDividerSize(6);\n\n        mainPanel.add(split, BorderLayout.CENTER);\n        return mainPanel;\n    }\n\n\n    private JPanel createKhuVucTimKiem() {\n        JPanel panel = new JPanel(new FlowLayout(FlowLayout.LEFT, 10, 10));\n        panel.setBackground(Color.WHITE);\n        TitledBorder title = BorderFactory.createTitledBorder(BorderFactory.createLineBorder(Color.LIGHT_GRAY),\n                \"Tìm kiếm chuyến tàu\");\n        title.setTitleFont(title.getTitleFont().deriveFont(Font.BOLD, 14f));\n        panel.setBorder(title);\n\n        Vector<Ga> danhSachGa = new GaDao().layDanhSachGa();\n\n        panel.add(new JLabel(\"Ga đi\"));\n        cbGaDi = new JComboBox<>(danhSachGa);\n        panel.add(cbGaDi);\n\n        panel.add(new JLabel(\"Ga đến\"));\n        cbGaDen = new JComboBox<>(danhSachGa);\n        panel.add(cbGaDen);\n\n        if (danhSachGa.size() > 1) {\n            cbGaDen.setSelectedIndex(3);\n        }\n\n        panel.add(new JLabel(\"Ngày đi\"));\n        dateField = new JTextField(\"10/11/2025\", 8);\n        dateField.setPreferredSize(new Dimension(80, 25));\n        panel.add(dateField);\n\n        btnTimChuyen = new JButton(\"Tìm chuyến\");\n        styleNutChinh(btnTimChuyen);\n        btnTimChuyen.addActionListener(this);\n        panel.add(btnTimChuyen);\n\n        datCanhKhuVuc(panel);\n        return panel;\n    }\n\n    private JScrollPane createKhuVucDanhSachChuyenTau() {\n        String[] columnNames = {\"Tên Chuyến\", \"Ngày đi\", \"Giờ đi\"};\n        tableModel = new DefaultTableModel(columnNames, 0) {\n            @Override public boolean isCellEditable(int row, int column) { return false; }\n        };\n\n        tableChuyenTau = new JTable(tableModel);\n        tableChuyenTau.addMouseListener(this);\n\n        JScrollPane scrollPane = new JScrollPane(tableChuyenTau);\n        scrollPane.setPreferredSize(new Dimension(400, 100));\n        scrollPane.setMaximumSize(new Dimension(1200, 100));\n        return scrollPane;\n    }\n\n    private JPanel createKhuVucChonLoaiKhach() {\n        JPanel panel = new JPanel();\n        panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));\n        panel.setBackground(Color.WHITE);\n\n        TitledBorder title = BorderFactory.createTitledBorder(BorderFactory.createLineBorder(Color.LIGHT_GRAY),\n                \"Chọn toa và số lượng khách\");\n        title.setTitleFont(title.getTitleFont().deriveFont(Font.BOLD, 14f));\n        panel.setBorder(title);\n\n        JPanel topRow = new JPanel(new FlowLayout(FlowLayout.LEFT, 10, 10));\n        topRow.setOpaque(false);\n        topRow.setAlignmentX(Component.LEFT_ALIGNMENT);\n\n        // --- KHU VỰC NHẬP TỔNG SỐ KHÁCH (DÙNG ToaPanelTangGiam) ---\n\n        // 1. Khai báo và khởi tạo JTextField cho Tổng số khách\n        // Khởi tạo ở đây nếu chưa phải là biến cấp lớp hoặc đảm bảo biến đã được khai báo.\n        //columns = 3 để giới hạn độ rộng hiển thị\n        txtTongSoKhach = new JTextField(2);\n\n        txtTongSoKhach.setPreferredSize(new Dimension(60, 30));\n        txtTongSoKhach.setMaximumSize(new Dimension(60, 30));\n        // 2. Tạo control tăng/giảm chỉ cho TỔNG SỐ KHÁCH\n        pnlTongSoKhachControl = ToaPanelTangGiam(\"Tổng số khách\", \"1\", txtTongSoKhach);\n\n        // Giảm giới hạn chiều rộng để panel không chiếm hết không gian (tùy chọn)\n        pnlTongSoKhachControl.setMaximumSize(new Dimension(300, 40));\n\n        // Thêm control nhập số lượng vào topRow\n        topRow.add(pnlTongSoKhachControl);\n\n        // Thêm topRow (chứa control nhập tổng khách) vào panel chính\n        panel.add(topRow);\n\n        // --- KHU VỰC CHỌN TOA (Giữ nguyên) ---\n        pnlToa = new JPanel(new FlowLayout(FlowLayout.LEFT, 5, 10));\n        pnlToa.setOpaque(false);\n        pnlToa.setAlignmentX(Component.LEFT_ALIGNMENT);\n        pnlToa.add(new JLabel(\"Chọn toa:\"));\n        panel.add(pnlToa);\n\n        // Điều chỉnh giới hạn chiều cao phù hợp\n        panel.setMaximumSize(new Dimension(1200, 150));\n\n        // Gọi hàm cập nhật trạng thái\n        capNhatSoLuongYeuCau();\n        datCanhKhuVuc(panel);\n        return panel;\n    }\n    // ====================\n    // MODULE: SpinBox helpers\n    // ====================\n    private JPanel ToaPanelTangGiam(String labelText, String initialValue, JTextField targetField) {\n        JPanel panel = new JPanel(new BorderLayout(5, 0));\n        panel.setOpaque(false);\n        panel.setAlignmentX(Component.LEFT_ALIGNMENT);\n        panel.setBorder(new EmptyBorder(5, 0, 5, 0));\n\n        JPanel labelDiscountPanel = new JPanel(new FlowLayout(FlowLayout.LEFT, 5, 0));\n        labelDiscountPanel.setOpaque(false);\n\n        JLabel mainLabel = new JLabel(labelText);\n        mainLabel.setFont(mainLabel.getFont().deriveFont(Font.BOLD, 14f));\n        labelDiscountPanel.add(mainLabel);\n\n        JPanel controlPanel = new JPanel(new FlowLayout(FlowLayout.CENTER, 5, 0));\n        controlPanel.setOpaque(false);\n\n        JButton btnMinus = new JButton(\"−\");\n        btnMinus.setPreferredSize(new Dimension(30, 30));\n        btnMinus.setMargin(new Insets(0, 0, 0, 0));\n        styleSpinButton(btnMinus);\n\n        targetField.setText(initialValue);\n        targetField.setHorizontalAlignment(JTextField.CENTER);\n\n        targetField.setPreferredSize(new Dimension(60, 30));\n        targetField.setMaximumSize(new Dimension(60, 30));\n        targetField.setEditable(false);\n\n        JButton btnPlus = new JButton(\"+\");\n        btnPlus.setPreferredSize(new Dimension(30, 30));\n        btnPlus.setMargin(new Insets(0, 0, 0, 0));\n        styleSpinButton(btnPlus);\n\n        btnPlus.addActionListener(e -> changeQuantity(targetField, 1));\n        btnMinus.addActionListener(e -> changeQuantity(targetField, -1));\n\n        controlPanel.add(btnMinus);\n        controlPanel.add(targetField);\n        controlPanel.add(btnPlus);\n\n        panel.add(controlPanel, BorderLayout.EAST);\n        panel.setMaximumSize(new Dimension(Integer.MAX_VALUE, 40));\n        return panel;\n    }\n\n    private void styleSpinButton(JButton btn) {\n        btn.setBackground(Color.WHITE);\n        btn.setForeground(Color.BLACK);\n        btn.setFocusPainted(false);\n        btn.setBorder(BorderFactory.createLineBorder(Color.LIGHT_GRAY));\n    }\n    private int parseTextFieldToInt(JTextField field) {\n        try {\n            if (field.getText().trim().isEmpty()) return 0;\n            return Integer.parseInt(field.getText().trim());\n        } catch (NumberFormatException e) {\n            return 0;\n        }\n    }\n\n    private void changeQuantity(JTextField field, int delta) {\n        int currentValue = parseTextFieldToInt(field);\n        int newValue = currentValue + delta;\n        if (newValue < 0) newValue = 0;\n        field.setText(String.valueOf(newValue));\n        capNhatSoLuongYeuCau();\n    }\n\n\n    // MODULE: Logic tính toán & cập nhật trạng thái (ĐÃ SỬA)\n// ====================\n    private void capNhatSoLuongYeuCau() {\n        // Chỉ lấy giá trị từ trường TỔNG SỐ KHÁCH\n        int tongSoKhachMoi = parseTextFieldToInt(txtTongSoKhach);\n\n        // Cập nhật label (Nếu lblTongSoKhach không được sử dụng, có thể bỏ qua)\n        // Nếu bạn muốn hiển thị lại label tổng số khách, hãy thêm nó vào createKhuVucChonLoaiKhach()\n        // Nếu không, hãy kiểm tra xem bạn có cần nó nữa không.\n        if (lblTongSoKhach != null) {\n            lblTongSoKhach.setText(String.valueOf(tongSoKhachMoi));\n        }\n\n        // Cập nhật Map yêu cầu chỉ với TỔNG SỐ KHÁCH\n        soLuongYeuCau.clear();\n        // Bây giờ, chỉ cần một mục để lưu tổng số khách.\n        // Bạn có thể dùng một key chung hoặc key cũ là \"NguoiLon\" nếu hệ thống logic của bạn\n        // cần ít nhất 1 loại khách để hoạt động. Tôi dùng key mới.\n        soLuongYeuCau.put(\"TongSoKhach\", tongSoKhachMoi);\n\n        // Xóa các dòng cập nhật cho từng loại khách đã bị loại bỏ\n\n        // Cảnh báo nếu số ghế đã chọn vượt quá tổng số khách mới\n        if (danhSachGheDaChon != null && danhSachGheDaChon.size() > tongSoKhachMoi) {\n            JOptionPane.showMessageDialog(null, // Thay thế this bằng null nếu đây không phải là class JDialog/JFrame\n                    \"Số lượng ghế đã chọn (\" + danhSachGheDaChon.size() + \") vượt quá Tổng số khách mới (\" + tongSoKhachMoi + \"). Vui lòng hủy chọn bớt.\",\n                    \"Cảnh báo\", JOptionPane.WARNING_MESSAGE);\n        }\n    }\n\n    private JPanel createKhuVucChonViTriGhe() {\n        JPanel panel = new JPanel();\n        panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));\n        panel.setBackground(Color.WHITE);\n\n        TitledBorder title = BorderFactory.createTitledBorder(BorderFactory.createLineBorder(Color.LIGHT_GRAY),\n                \"Chọn vị trí của ghế\");\n        title.setTitleFont(title.getTitleFont().deriveFont(Font.BOLD, 14f));\n        panel.setBorder(title);\n\n        pnlSoDoGhe = new JPanel();\n        pnlSoDoGhe.setAlignmentX(Component.LEFT_ALIGNMENT);\n\n        JScrollPane soDoScrollPane = new JScrollPane(pnlSoDoGhe);\n        soDoScrollPane.setBorder(BorderFactory.createEmptyBorder());\n        soDoScrollPane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_AS_NEEDED);\n        soDoScrollPane.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_NEVER);\n        soDoScrollPane.setPreferredSize(new Dimension(100, 150));\n        soDoScrollPane.setMaximumSize(new Dimension(Integer.MAX_VALUE, 150));\n\n        panel.add(soDoScrollPane);\n        panel.add(Box.createVerticalStrut(10));\n\n        JPanel legendPanel = new JPanel(new FlowLayout(FlowLayout.LEFT, 15, 5));\n        legendPanel.setOpaque(false);\n        legendPanel.add(taoMucChuGiai(Color.LIGHT_GRAY, \"Chỗ trống\"));\n        legendPanel.add(taoMucChuGiai(Color.BLACK, \"Đã đặt\"));\n        legendPanel.add(taoMucChuGiai(new Color(0, 123, 255), \"Đang chọn\"));\n        legendPanel.setAlignmentX(Component.LEFT_ALIGNMENT);\n        panel.add(legendPanel);\n        panel.add(Box.createVerticalStrut(5));\n\n        pnlDanhSachGheDaCho = new JPanel(new FlowLayout(FlowLayout.LEFT, 10, 5));\n        pnlDanhSachGheDaCho.setOpaque(false);\n        pnlDanhSachGheDaCho.setAlignmentX(Component.LEFT_ALIGNMENT);\n        pnlDanhSachGheDaCho.add(new JLabel(\"Ghế đã chọn:\"));\n        capNhatDanhSachGheDaChonUI();\n        panel.add(pnlDanhSachGheDaCho);\n\n        datCanhKhuVuc(panel);\n        return panel;\n    }\n\n    private JPanel createKhuVucTongTien() {\n        JPanel fullSummary = new JPanel(new BorderLayout());\n        fullSummary.setBackground(Color.white);\n        fullSummary.setBorder(new EmptyBorder(5, 10, 5, 10));\n\n        JPanel summaryPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT, 15, 0));\n        summaryPanel.setOpaque(false);\n        summaryPanel.add(new JLabel(\"Đã chọn: X/Y\"));\n\n        lblTotalPrice = new JLabel(\"Tổng tiền vé: 0 VNĐ\");\n        lblTotalPrice.setFont(lblTotalPrice.getFont().deriveFont(Font.BOLD, 14f));\n        lblTotalPrice.setForeground(new Color(255, 165, 0));\n        summaryPanel.add(lblTotalPrice);\n\n        fullSummary.add(summaryPanel, BorderLayout.EAST);\n        datCanhKhuVuc(fullSummary);\n        return fullSummary;\n    }\n\n    private JPanel createKhuVucThongTinKhach() {\n        JPanel panel = new JPanel(new BorderLayout());\n        panel.setBackground(Color.WHITE);\n        panel.setBorder(BorderFactory.createTitledBorder(BorderFactory.createLineBorder(Color.LIGHT_GRAY),\n                \"Thông tin khách hàng\"));\n\n        JPanel infoScrollPanel = new JPanel();\n        infoScrollPanel.setLayout(new BoxLayout(infoScrollPanel, BoxLayout.Y_AXIS));\n        infoScrollPanel.setOpaque(false);\n        infoScrollPanel.setBorder(new EmptyBorder(5, 5, 5, 5));\n\n        infoScrollPanel.add(new JLabel(\"Chọn ghế để thêm thông tin.\"));\n        infoScrollPanel.add(Box.createVerticalGlue());\n//        infoScrollPanel.setPreferredSize(new Dimension(800, 300));\n\n        thongTinKhachScrollPane = new JScrollPane(infoScrollPanel);\n        thongTinKhachScrollPane.setBorder(null);\n        thongTinKhachScrollPane.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED);\n        thongTinKhachScrollPane.setPreferredSize(new Dimension(700, 300));\n        panel.add(thongTinKhachScrollPane, BorderLayout.CENTER);\n\n        SwingUtilities.invokeLater(this::capNhatThongTinKhachUI);\n\n        JPanel buttonPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT, 10, 10));\n        buttonPanel.setOpaque(false);\n\n        cancelButton = new JButton(\"< Hủy\");\n        cancelButton.setPreferredSize(new Dimension(80, 40));\n        cancelButton.setFont(cancelButton.getFont().deriveFont(Font.BOLD, 14f));\n        cancelButton.setBackground(new Color(220, 53, 69));\n        cancelButton.setForeground(Color.WHITE);\n\n        nextButton = new JButton(\"Tiếp theo >\");\n        nextButton.setPreferredSize(new Dimension(120, 40));\n        nextButton.setFont(nextButton.getFont().deriveFont(Font.BOLD, 14f));\n        nextButton.setBackground(new Color(0, 123, 255));\n        nextButton.setForeground(Color.WHITE);\n\n        buttonPanel.add(cancelButton);\n        buttonPanel.add(nextButton);\n        //Đăng ký sự kiện\n        cancelButton.addActionListener(this);\n        nextButton.addActionListener(this);\n\n        JPanel fullSummary = new JPanel(new BorderLayout());\n        fullSummary.setBackground(Color.white);\n        fullSummary.setBorder(new EmptyBorder(5, 10, 5, 10));\n\n        JPanel summaryPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT, 15, 0));\n        summaryPanel.setOpaque(false);\n        summaryPanel.add(new JLabel(\"Đã chọn: X/Y\"));\n\n        lblTotalPrice = new JLabel(\"Tổng tiền vé: 0 VNĐ\");\n        lblTotalPrice.setFont(lblTotalPrice.getFont().deriveFont(Font.BOLD, 14f));\n        lblTotalPrice.setForeground(new Color(255, 165, 0));\n        summaryPanel.add(lblTotalPrice);\n\n        fullSummary.add(summaryPanel, BorderLayout.EAST);\n        datCanhKhuVuc(fullSummary);\n\n        JPanel footerPanel = new JPanel();\n        footerPanel.setLayout(new BoxLayout(footerPanel, BoxLayout.Y_AXIS));\n        footerPanel.setOpaque(false);\n\n        footerPanel.add(fullSummary);\n        footerPanel.add(buttonPanel);\n\n        panel.add(footerPanel, BorderLayout.SOUTH);\n\n        return panel;\n    }\n\n    private JPanel createKhachPanel(ChiTietKhach khach) { // SỬA: Nhận ChiTietKhach\n        JPanel panel = new JPanel();\n        panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));\n        panel.setOpaque(false);\n        // Vẫn giữ border mờ để phân tách các form khách hàng\n        panel.setBorder(BorderFactory.createMatteBorder(0, 0, 1, 0, Color.LIGHT_GRAY));\n        panel.setAlignmentX(Component.LEFT_ALIGNMENT);\n\n        String soCho = khach.choDat().getSoCho(); // SỬA: Truy cập qua accessor\n        String soThuTuToa = laySoThuTuToa(khach.choDat().getMaToa()); // SỬA: Truy cập qua accessor\n        String loaiKhachHienThi = getTenLoaiVeHienThi(khach.maLoaiVe()); // SỬA: Truy cập qua accessor\n\n        // --- Cố định kích thước cho các Field và ComboBox ---\n        final int FIELD_HEIGHT = 28;\n        final int W_TEXT = 120;\n        final int W_COMBO = 120;\n        final Dimension FIXED_FIELD_SIZE = new Dimension(W_TEXT, FIELD_HEIGHT);\n        final Dimension FIXED_COMBO_SIZE = new Dimension(W_COMBO, FIELD_HEIGHT);\n        final Dimension FIXED_TUOI_SIZE = new Dimension(50, FIELD_HEIGHT);\n\n        // --- 1. Header Row (Ghế, Loại khách, Giá) ---\n        JPanel headerRow = new JPanel(new BorderLayout());\n        headerRow.setOpaque(false);\n        headerRow.setBorder(new EmptyBorder(5, 0, 5, 0));\n        headerRow.setMaximumSize(new Dimension(Integer.MAX_VALUE, FIELD_HEIGHT + 10)); // Cố định chiều cao\n\n        JPanel leftHeader = new JPanel(new FlowLayout(FlowLayout.LEFT, 10, 0));\n        leftHeader.setOpaque(false);\n        JLabel maGheLabel = new JLabel(\"Ghế: \" + soCho + \" / Toa: \" + soThuTuToa);\n        maGheLabel.setFont(maGheLabel.getFont().deriveFont(Font.BOLD));\n        leftHeader.add(maGheLabel);\n\n        JComboBox<String> cbLoaiKhach = new JComboBox<>(getLoaiVeOptions());\n        cbLoaiKhach.setSelectedItem(loaiKhachHienThi);\n\n        // Cố định kích thước ComboBox\n        cbLoaiKhach.setPreferredSize(FIXED_COMBO_SIZE);\n        cbLoaiKhach.setMaximumSize(FIXED_COMBO_SIZE);\n\n        cbLoaiKhach.addActionListener(e -> {\n            String maMoi = getMaLoaiVeFromHienThi((String) cbLoaiKhach.getSelectedItem());\n\n            // SỬA: Tạo bản sao mới của Record với maLoaiVe được cập nhật và thay thế nó trong Map\n            ChiTietKhach updatedKhach = new ChiTietKhach(\n                    khach.choDat(), khach.maLoaiVe(), khach.hoTen(), khach.cccd(), khach.sdt(), khach.tuoi()\n            ).withMaLoaiVe(maMoi); // SỬ DỤNG PHƯƠNG THỨC WITH HỖ TRỢ BÊN DƯỚI\n\n            danhSachKhachHang.put(khach.choDat().getMaCho(), updatedKhach); // Cập nhật Map\n\n            // Recompute price for this seat and update UI\n            try {\n                long gia = computeTicketPrice(updatedKhach.choDat(), updatedKhach.maLoaiVe());\n                danhSachGiaVe.put(updatedKhach.choDat().getMaCho(), gia);\n            } catch (Exception ex) {\n                JOptionPane.showMessageDialog(this, \"Không thể tính lại giá: \" + ex.getMessage(), \"Lỗi tính giá\", JOptionPane.ERROR_MESSAGE);\n                danhSachGiaVe.remove(updatedKhach.choDat().getMaCho());\n            }\n            capNhatThongTinKhachUI();\n            capNhatTongTienUI();\n        });\n        leftHeader.add(cbLoaiKhach);\n        headerRow.add(leftHeader, BorderLayout.WEST);\n\n        JLabel giaLabel = new JLabel(\"Giá vé sẽ được tính\");\n        giaLabel.setForeground(Color.BLUE);\n        headerRow.add(giaLabel, BorderLayout.EAST);\n\n        headerRow.setAlignmentX(Component.LEFT_ALIGNMENT);\n        panel.add(headerRow);\n\n        // --- 2. Detail Grid (Họ tên, Tuổi, SDT, CCCD) ---\n        JPanel detailGrid = new JPanel(new GridLayout(2, 4, 10, 5));\n        detailGrid.setOpaque(false);\n        detailGrid.setBorder(new EmptyBorder(5, 0, 5, 0));\n        detailGrid.setAlignmentX(Component.LEFT_ALIGNMENT);\n\n        // Đặt chiều cao ưu tiên cho Grid\n        int gridHeight = 2 * FIELD_HEIGHT + 10;\n        detailGrid.setMaximumSize(new Dimension(Integer.MAX_VALUE, gridHeight));\n\n\n        detailGrid.add(new JLabel(\"Họ và tên*\"));\n        JTextField hoTenField = new JTextField(khach.hoTen(), 10); // SỬA: Truy cập qua accessor\n        detailGrid.add(hoTenField);\n        detailGrid.add(new JLabel(\"Tuổi\"));\n        JTextField tuoiField = new JTextField(String.valueOf(khach.tuoi() > 0 ? khach.tuoi() : \"\"), 3); // SỬA: Truy cập qua accessor\n        detailGrid.add(tuoiField);\n\n        detailGrid.add(new JLabel(\"Số điện thoại\"));\n        JTextField sdtField = new JTextField(khach.sdt(), 10); // SỬA: Truy cập qua accessor\n        detailGrid.add(sdtField);\n        detailGrid.add(new JLabel(\"CCCD*\"));\n        JTextField cccdField = new JTextField(khach.cccd(), 10); // SỬA: Truy cập qua accessor\n        detailGrid.add(cccdField);\n\n        panel.add(detailGrid);\n\n        // ... (Code cố định kích thước giữ nguyên)\n\n        // --- 4. Focus Listeners (Giữ nguyên - CẦN SỬA ĐỂ CẬP NHẬT RECORD) ---\n        hoTenField.addFocusListener(new java.awt.event.FocusAdapter() { public void focusLost(java.awt.event.FocusEvent evt) {\n            updateKhachRecord(khach.choDat().getMaCho(), hoTenField.getText(), \"hoTen\");\n        }});\n        cccdField.addFocusListener(new java.awt.event.FocusAdapter() { public void focusLost(java.awt.event.FocusEvent evt) {\n            updateKhachRecord(khach.choDat().getMaCho(), cccdField.getText(), \"cccd\");\n        }});\n        sdtField.addFocusListener(new java.awt.event.FocusAdapter() { public void focusLost(java.awt.event.FocusEvent evt) {\n            updateKhachRecord(khach.choDat().getMaCho(), sdtField.getText(), \"sdt\");\n        }});\n        tuoiField.addFocusListener(new java.awt.event.FocusAdapter() {\n            public void focusLost(java.awt.event.FocusEvent evt) {\n                try {\n                    int tuoiMoi = Integer.parseInt(tuoiField.getText().trim());\n                    updateKhachRecord(khach.choDat().getMaCho(), String.valueOf(tuoiMoi), \"tuoi\");\n                } catch (Exception e) {\n                    updateKhachRecord(khach.choDat().getMaCho(), \"0\", \"tuoi\");\n                }\n            }\n        });\n\n\n        // --- 5. Cập nhật label giá (Giữ nguyên) ---\n        Long giaTinh = danhSachGiaVe.get(khach.choDat().getMaCho()); // SỬA: Truy cập qua accessor\n        if (giaTinh != null) {\n            giaLabel.setText(formatVnd(giaTinh));\n        } else {\n            // thử tính giá nếu chưa có (ví dụ khi UI gọi)\n            try {\n                long gia = computeTicketPrice(khach.choDat(), khach.maLoaiVe()); // SỬA: Truy cập qua accessor\n                danhSachGiaVe.put(khach.choDat().getMaCho(), gia);\n                giaLabel.setText(formatVnd(gia));\n            } catch (Exception ex) {\n                giaLabel.setText(\"Chưa có giá\");\n            }\n        }\n\n        // --- 6. Cố định chiều cao tổng thể của panel khách hàng ---\n        int totalPanelHeight = FIELD_HEIGHT + 10 + gridHeight + 10;\n        panel.setPreferredSize(new Dimension(400, totalPanelHeight));\n        panel.setMaximumSize(new Dimension(Integer.MAX_VALUE, totalPanelHeight));\n\n        return panel;\n    }\n\n    // --- Helper: reset state/UI ---\n    private void resetAllData() {\n        danhSachGheDaChon.clear();\n        danhSachKhachHang.clear();\n        tatCaChoDatToaHienTai.clear();\n        seatButtonsMap.clear();\n        danhSachGiaVe.clear();\n\n        maChuyenTauHienTai = null;\n        maToaHienTai = null;\n        lastSelectedToaButton = null;\n\n        SwingUtilities.invokeLater(() -> {\n            capNhatDanhSachGheDaChonUI();\n\n            if (pnlToa != null) {\n                pnlToa.removeAll();\n                pnlToa.add(new JLabel(\"Chọn toa:\"));\n                pnlToa.revalidate();\n                pnlToa.repaint();\n            }\n\n            if (pnlSoDoGhe != null) {\n                pnlSoDoGhe.removeAll();\n                pnlSoDoGhe.add(new JLabel(\"Chưa có sơ đồ ghế.\"));\n                pnlSoDoGhe.revalidate();\n                pnlSoDoGhe.repaint();\n            }\n\n            capNhatThongTinKhachUI();\n            capNhatTongTienUI();\n        });\n    }\n\n\n    private void capNhatThongTinKhachUI() {\n        if (thongTinKhachScrollPane == null) {\n            System.out.println(\"Lỗi: thongTinKhachScrollPane chưa được khởi tạo.\");\n            return;\n        }\n        JPanel infoScrollPanel = (JPanel) thongTinKhachScrollPane.getViewport().getView();\n        infoScrollPanel.removeAll();\n\n        // SỬA: Lấy danh sách ChiTietKhach\n        List<ChiTietKhach> danhSachChiTiet = new ArrayList<>(danhSachKhachHang.values());\n\n        if (danhSachChiTiet.isEmpty()) {\n            infoScrollPanel.add(new JLabel(\"Chưa có ghế nào được chọn.\"));\n            infoScrollPanel.add(Box.createVerticalGlue());\n            infoScrollPanel.revalidate();\n            infoScrollPanel.repaint();\n            return;\n        }\n\n        // SỬA: Vòng lặp chỉ hiển thị các form ChiTietKhach\n        for (ChiTietKhach khach : danhSachChiTiet) {\n            JPanel khachPanel = createKhachPanel(khach);\n            infoScrollPanel.add(khachPanel);\n        }\n\n        infoScrollPanel.add(Box.createVerticalGlue());\n        infoScrollPanel.revalidate();\n        infoScrollPanel.repaint();\n    }\n\n    // --- Helper: switch main frame to another panel ---\n    private void switchToPanel(Component panel) {\n        Window w = SwingUtilities.getWindowAncestor(this);\n        if (w instanceof JFrame) {\n            JFrame frame = (JFrame) w;\n            frame.getContentPane().removeAll();\n            frame.getContentPane().add(panel, BorderLayout.CENTER);\n            frame.revalidate();\n            frame.repaint();\n        } else {\n            JOptionPane.showMessageDialog(this,\n                    \"Không thể chuyển màn hình: top-level window không phải JFrame.\",\n                    \"Lỗi\", JOptionPane.ERROR_MESSAGE);\n        }\n    }\n\n\n\n    // --- Small helper to show instantiation error ---\n    private void showInstantiationError(String className, Exception ex) {\n        JOptionPane.showMessageDialog(this,\n                \"Không thể mở \" + className + \": \" + ex.getMessage(),\n                \"Lỗi\", JOptionPane.ERROR_MESSAGE);\n    }\n\n    // ====================\n    // MODULE: UI Helper Methods (style / small components)\n    // ====================\n    private void datCanhKhuVuc(JPanel panel) {\n        panel.setAlignmentX(Component.LEFT_ALIGNMENT);\n        panel.setMaximumSize(new Dimension(Integer.MAX_VALUE, panel.getPreferredSize().height));\n    }\n\n    private void styleNutChinh(JButton btn) {\n        btn.setBackground(new Color(0, 123, 255));\n        btn.setForeground(Color.WHITE);\n        btn.setPreferredSize(new Dimension(100, 25));\n    }\n\n    private JButton taoNutToa(String text, Color bgColor, Color fgColor) {\n        JButton btn = new JButton(String.format(\"<html><center>%s</center></html>\", text.replace(\"\\n\", \"<br>\")));\n        btn.setPreferredSize(new Dimension(110, 60));\n        btn.setFont(btn.getFont().deriveFont(Font.BOLD, 12f));\n        btn.setBackground(bgColor != null ? bgColor : Color.LIGHT_GRAY);\n        btn.setForeground(fgColor != null ? fgColor : Color.BLACK);\n        btn.setFocusPainted(false);\n        return btn;\n    }\n\n    private JPanel taoMucChuGiai(Color color, String text) {\n        JPanel panel = new JPanel(new FlowLayout(FlowLayout.LEFT, 5, 0));\n        panel.setOpaque(false);\n        JLabel square = new JLabel();\n        square.setPreferredSize(new Dimension(15, 15));\n        square.setOpaque(true);\n        square.setBackground(color);\n        square.setBorder(BorderFactory.createLineBorder(Color.BLACK));\n        panel.add(square);\n        panel.add(new JLabel(text));\n        return panel;\n    }\n\n\n\n\n\n    private String[] getLoaiVeOptions() {\n        return new String[] {\n                getTenLoaiVeHienThi(MA_VE_NL),\n                getTenLoaiVeHienThi(MA_VE_TE),\n                getTenLoaiVeHienThi(MA_VE_NCT),\n                getTenLoaiVeHienThi(MA_VE_SV)\n        };\n    }\n\n    private String getTenLoaiVeHienThi(String maLoaiVe) {\n        return switch (maLoaiVe) {\n            case \"VT01\" -> \"Người lớn (VT01)\";\n            case \"VT02\" -> \"Trẻ em (VT02)\";\n            case \"VT03\" -> \"Người cao tuổi (VT03)\";\n            case \"VT04\" -> \"Sinh viên (VT04)\";\n            default -> \"Người lớn (VT01)\";\n        };\n    }\n\n    private String getMaLoaiVeFromHienThi(String tenHienThi) {\n        if (tenHienThi.contains(\"(VT01)\")) return \"VT01\";\n        if (tenHienThi.contains(\"(VT02)\")) return \"VT02\";\n        if (tenHienThi.contains(\"(VT03)\")) return \"VT03\";\n        if (tenHienThi.contains(\"(VT04)\")) return \"VT04\";\n        return \"VT01\";\n    }\n\n    private Vector<String> taoDanhSachLoaiVeUuTien() {\n        Vector<String> dsMaVe = new Vector<>();\n        themLoaiVeVaoDanhSach(dsMaVe, MA_VE_NCT, soLuongYeuCau.getOrDefault(\"NguoiCaoTuoi\", 0));\n        themLoaiVeVaoDanhSach(dsMaVe, MA_VE_TE, soLuongYeuCau.getOrDefault(\"TreCon\", 0));\n        themLoaiVeVaoDanhSach(dsMaVe, MA_VE_SV, soLuongYeuCau.getOrDefault(\"SinhVien\", 0));\n        themLoaiVeVaoDanhSach(dsMaVe, MA_VE_NL, soLuongYeuCau.getOrDefault(\"NguoiLon\", 0));\n        return dsMaVe;\n    }\n\n    private void themLoaiVeVaoDanhSach(Vector<String> ds, String maVe, int soLuong) {\n        for (int i = 0; i < soLuong; i++) ds.add(maVe);\n    }\n\n    // ====================\n    // MODULE: Data / Actions (tìm chuyến, nạp dữ liệu)\n    // ====================\n    private void timKiemChuyenTau() {\n        Ga gaDiSelected = (Ga) cbGaDi.getSelectedItem();\n        Ga gaDenSelected = (Ga) cbGaDen.getSelectedItem();\n\n        if (gaDiSelected == null || gaDenSelected == null) {\n            JOptionPane.showMessageDialog(null, \"Vui lòng chọn ga đi và ga đến.\", \"Lỗi nhập liệu\", JOptionPane.ERROR_MESSAGE);\n            return;\n        }\n        if (gaDiSelected.getMaGa().equals(gaDenSelected.getMaGa())) {\n            JOptionPane.showMessageDialog(null, \"Ga đi và Ga đến không được trùng nhau.\", \"Lỗi nhập liệu\", JOptionPane.ERROR_MESSAGE);\n            return;\n        }\n\n        String maGaDi = gaDiSelected.getMaGa();\n        String maGaDen = gaDenSelected.getMaGa();\n        String ngayDiString = dateField.getText();\n        String ngayDiSQL;\n        try {\n            date = INPUT_DATE_FORMAT.parse(ngayDiString);\n            ngayDiSQL = SQL_DATE_FORMAT.format(date);\n        } catch (ParseException e) {\n            JOptionPane.showMessageDialog(null, \"Ngày đi không hợp lệ. Vui lòng nhập theo định dạng dd/MM/yyyy.\", \"Lỗi nhập liệu\", JOptionPane.ERROR_MESSAGE);\n            return;\n        }\n\n        ChuyenTauDao dao = new ChuyenTauDao();\n        ketQua = dao.timChuyenTau(maGaDi, maGaDen, ngayDiSQL);\n\n        if (ketQua == null || ketQua.isEmpty()) {\n            JOptionPane.showMessageDialog(null, \"Không tìm thấy chuyến tàu nào phù hợp.\", \"Thông báo\", JOptionPane.INFORMATION_MESSAGE);\n        }\n\n        napDuLieuLenBang(ketQua);\n    }\n\n    private void napDuLieuLenBang(List<ChuyenTau> danhSach) {\n        DefaultTableModel model = (DefaultTableModel) tableChuyenTau.getModel();\n        model.setRowCount(0);\n        if (danhSach == null) return;\n        for (ChuyenTau ct : danhSach) {\n            Object[] rowData = {ct.getMaChuyenTau(), ct.getNgayKhoiHanh(), ct.getGioKhoiHanh()};\n            model.addRow(rowData);\n        }\n    }\n\n    private void hienThiDanhSachToaTau(String maTau) {\n        List<Toa> danhSachToa = new ArrayList<>();\n        try {\n            ToaDAO toaTauDAO = new ToaDAO();\n            danhSachToa = toaTauDAO.layToaTheoMaTau(maTau);\n        } catch (Exception e) {\n            JOptionPane.showMessageDialog(this, \"Lỗi khi lấy danh sách toa tàu: \" + e.getMessage(), \"Lỗi\", JOptionPane.ERROR_MESSAGE);\n            e.printStackTrace();\n        }\n        napNutToa(danhSachToa);\n    }\n\n    public void napNutToa(List<Toa> danhSachToa) {\n        pnlToa.removeAll();\n        pnlToa.add(new JLabel(\"Chọn toa:\"));\n\n        for (Toa toa : danhSachToa) {\n            String soThuTuToa = laySoThuTuToa(toa.getMaToa());\n            String text = \"Toa \" + soThuTuToa + \"\\n\" + toa.getLoaiToa();\n            JButton btnToa = taoNutToa(text, null, null);\n            btnToa.addActionListener(e -> xuLyChonToa(btnToa, toa.getMaToa()));\n            pnlToa.add(btnToa);\n        }\n        pnlToa.revalidate();\n        pnlToa.repaint();\n    }\n\n    // ====================\n    // MODULE: XỬ LÝ CHỌN TOA / VẼ SƠ ĐỒ GHẾ\n    // ====================\n    private void xuLyChonToa(JButton currentButton, String maToa) {\n        maToaHienTai = maToa;\n\n        // Đổi màu nút\n        if (lastSelectedToaButton != null) {\n            lastSelectedToaButton.setBackground(Color.LIGHT_GRAY);\n            lastSelectedToaButton.setForeground(Color.BLACK);\n        }\n        currentButton.setBackground(new Color(0, 123, 255));\n        currentButton.setForeground(Color.WHITE);\n        lastSelectedToaButton = currentButton;\n\n        if (this.maChuyenTauHienTai == null || this.maChuyenTauHienTai.isEmpty()) {\n            JOptionPane.showMessageDialog(null, \"Vui lòng chọn chuyến tàu trước.\", \"Lỗi dữ liệu\", JOptionPane.WARNING_MESSAGE);\n            pnlSoDoGhe.removeAll();\n            pnlSoDoGhe.add(new JLabel(\"Chưa chọn chuyến tàu.\"));\n            pnlSoDoGhe.revalidate();\n            pnlSoDoGhe.repaint();\n            return;\n        }\n\n        System.out.println(\"Đã chọn Toa: \" + maToa + \". Tiến hành tải sơ đồ ghế.\" );\n\n        List<ChoDat> danhSachChoDat = choDatDao.getDanhSachChoDatByMaToaVaTrangThai(\n                maToa,\n                maChuyenTauHienTai\n        );\n\n        if (danhSachChoDat.isEmpty()) {\n            pnlSoDoGhe.removeAll();\n            pnlSoDoGhe.add(new JLabel(\"Toa này chưa có dữ liệu chỗ đặt.\"));\n            pnlSoDoGhe.revalidate();\n            pnlSoDoGhe.repaint();\n        } else {\n            veSoDoGhe(danhSachChoDat);\n        }\n    }\n\n    private String laySoThuTuToa(String maToa) {\n        if (maToa != null && maToa.contains(\"-\")) {\n            return maToa.substring(maToa.lastIndexOf('-') + 1);\n        }\n        return maToa;\n    }\n\n    private static final Dimension SQUARE_SEAT_SIZE = new Dimension(60, 30);\n\n    private void veSoDoGhe(List<ChoDat> danhSachChoDat) {\n        pnlSoDoGhe.removeAll();\n        seatButtonsMap.clear();\n        tatCaChoDatToaHienTai.clear();\n\n        pnlSoDoGhe.setLayout(new FlowLayout(FlowLayout.LEFT, 0, 0));\n        pnlSoDoGhe.setOpaque(true);\n        pnlSoDoGhe.setBackground(Color.WHITE);\n        pnlSoDoGhe.setBorder(new EmptyBorder(10, 10, 10, 10));\n\n        int rows = 4;\n        int columns = (int) Math.ceil((double) danhSachChoDat.size() / rows);\n        JPanel gridContainer = new JPanel(new GridLayout(rows, columns, 5, 5));\n        gridContainer.setOpaque(false);\n\n        for (ChoDat cho : danhSachChoDat) {\n            JButton btnCho = new JButton(cho.getSoCho());\n            btnCho.setPreferredSize(SQUARE_SEAT_SIZE);\n            btnCho.setMinimumSize(SQUARE_SEAT_SIZE);\n            btnCho.setMaximumSize(SQUARE_SEAT_SIZE);\n            btnCho.setFont(btnCho.getFont().deriveFont(Font.BOLD, 12f));\n\n            boolean isSelected = danhSachGheDaChon.containsKey(cho.getMaCho());\n            boolean isBooked = cho.isDaDat();\n            tatCaChoDatToaHienTai.put(cho.getMaCho(), cho);\n\n            if (isSelected) {\n                btnCho.setBackground(new Color(0, 123, 255));\n                btnCho.setForeground(Color.WHITE);\n                btnCho.setEnabled(true);\n                btnCho.setToolTipText(\"Ghế đang được chọn\");\n            } else if (isBooked) {\n                btnCho.setBackground(Color.BLACK);\n                btnCho.setForeground(Color.WHITE);\n                btnCho.setEnabled(false);\n                btnCho.setToolTipText(\"Ghế đã được bán\");\n            } else {\n                btnCho.setBackground(Color.LIGHT_GRAY);\n                btnCho.setForeground(Color.BLACK);\n                btnCho.setEnabled(true);\n            }\n\n            if (btnCho.isEnabled()) {\n                btnCho.addActionListener(e -> xuLyChonGhe(btnCho, cho));\n            }\n\n            seatButtonsMap.put(cho.getMaCho(), btnCho);\n            gridContainer.add(btnCho);\n        }\n\n        pnlSoDoGhe.add(gridContainer);\n        pnlSoDoGhe.revalidate();\n        pnlSoDoGhe.repaint();\n    }\n\n    // ====================\n    // MODULE: Chọn/Hủy ghế, cập nhật UI danh sách & form khách\n    // ====================\n    // ====================\n// MODULE: Chọn/Hủy ghế, cập nhật UI danh sách & form khách\n// ====================\n    private void xuLyChonGhe(JButton btnCho, ChoDat cho) {\n        String maCho = cho.getMaCho();\n\n        int tongSoKhachYeuCau = parseTextFieldToInt(txtTongSoKhach);\n\n        if (danhSachGheDaChon.containsKey(maCho)) {\n            // --- Logic Hủy chọn ghế ---\n            danhSachGheDaChon.remove(maCho);\n            danhSachGiaVe.remove(maCho);\n            danhSachKhachHang.remove(maCho); // Xóa Record ChiTietKhach\n            btnCho.setBackground(Color.LIGHT_GRAY);\n            btnCho.setForeground(Color.BLACK);\n        } else {\n            // --- Logic Chọn ghế ---\n            if (danhSachGheDaChon.size() >= tongSoKhachYeuCau) {\n                JOptionPane.showMessageDialog(this,\n                        \"Đã chọn đủ \" + tongSoKhachYeuCau + \" ghế. Vui lòng thay đổi số lượng khách hoặc hủy chọn ghế cũ trước.\",\n                        \"Giới hạn chọn\", JOptionPane.WARNING_MESSAGE);\n                return;\n            }\n\n            // SỬA: Tạo đối tượng ChiTietKhach (Record) mới\n            ChiTietKhach chiTietKhach = new ChiTietKhach(\n                    cho,            // choDat\n                    MA_VE_NL,       // maLoaiVe mặc định\n                    \"\",             // hoTen mặc định\n                    \"\",             // cccd mặc định\n                    \"\",             // sdt mặc định\n                    0               // tuoi mặc định\n            );\n\n            // Tính giá cho ghế ngay khi chọn\n            try {\n                // SỬA: Truyền maLoaiVe từ Record mới\n                long gia = computeTicketPrice(cho, chiTietKhach.maLoaiVe());\n                danhSachGiaVe.put(maCho, gia);\n            } catch (Exception ex) {\n                JOptionPane.showMessageDialog(this,\n                        \"Không thể tính giá cho ghế \" + cho.getSoCho() + \": \" + ex.getMessage(),\n                        \"Lỗi tính giá\", JOptionPane.ERROR_MESSAGE);\n                return;\n            }\n\n            danhSachGheDaChon.put(maCho, cho);\n            btnCho.setBackground(new Color(0, 123, 255));\n            btnCho.setForeground(Color.WHITE);\n\n            // SỬA: Thêm Record ChiTietKhach vào Map\n            danhSachKhachHang.put(maCho, chiTietKhach);\n        }\n\n        capNhatDanhSachGheDaChonUI();\n        capNhatThongTinKhachUI();\n        capNhatTongTienUI();\n    }\n\n    private void xuLyHuyChonGhe(String maCho) {\n        danhSachGheDaChon.remove(maCho);\n        danhSachGiaVe.remove(maCho);\n        JButton btnCho = seatButtonsMap.get(maCho);\n        if (btnCho != null) {\n            btnCho.setBackground(Color.LIGHT_GRAY);\n            btnCho.setForeground(Color.BLACK);\n        }\n        capNhatDanhSachGheDaChonUI();\n        capNhatThongTinKhachUI();\n        capNhatTongTienUI();\n    }\n\n    private void capNhatDanhSachGheDaChonUI() {\n        pnlDanhSachGheDaCho.removeAll();\n        pnlDanhSachGheDaCho.add(new JLabel(\"Ghế đã chọn (\" + danhSachGheDaChon.size() + \"):\"));\n        for (ChoDat cho : danhSachGheDaChon.values()) {\n            String soThuTuToa = laySoThuTuToa(cho.getMaToa());\n            String soCho = cho.getSoCho();\n            JButton btnGhe = taoNutGheDaChon(cho.getMaCho(), soThuTuToa, soCho);\n            pnlDanhSachGheDaCho.add(btnGhe);\n        }\n        pnlDanhSachGheDaCho.revalidate();\n        pnlDanhSachGheDaCho.repaint();\n    }\n\n    private JButton taoNutGheDaChon(String maGhe, String soThuTuToa, String soCho) {\n        String text = \"Chỗ \" + soCho + \", Toa \" + soThuTuToa;\n        JButton btn = new JButton(text);\n        btn.setBackground(new Color(0, 123, 255));\n        btn.setForeground(Color.WHITE);\n        btn.setFont(btn.getFont().deriveFont(Font.BOLD, 12f));\n        btn.setFocusPainted(false);\n        btn.setPreferredSize(new Dimension(120, 25));\n        btn.addActionListener(e -> xuLyHuyChonGhe(maGhe));\n        return btn;\n    }\n\n\n\n    // ====================\n    // MODULE: Event handlers (Mouse)\n    // ====================\n    @Override\n    public void mouseClicked(MouseEvent e) {\n        int selectedRow = tableChuyenTau.getSelectedRow();\n        if (selectedRow != -1 && ketQua != null && selectedRow < ketQua.size()) {\n            String maTau = ketQua.get(selectedRow).getMaTau();\n            String maChuyenTauMoi = ketQua.get(selectedRow).getMaChuyenTau();\n\n            // Nếu chuyển sang chuyến tàu khác -> reset toàn bộ trạng thái liên quan\n            if (!maChuyenTauMoi.equals(maChuyenTauHienTai)) {\n                danhSachGheDaChon.clear();\n                danhSachKhachHang.clear();\n                danhSachGiaVe.clear();\n\n                lastSelectedToaButton = null;\n                maToaHienTai = null;\n                seatButtonsMap.clear();\n                tatCaChoDatToaHienTai.clear();\n\n                capNhatDanhSachGheDaChonUI();\n                pnlToa.removeAll();\n                pnlToa.add(new JLabel(\"Chọn toa: (Đang tải...)\"));\n                pnlToa.revalidate();\n                pnlToa.repaint();\n\n                pnlSoDoGhe.removeAll();\n                pnlSoDoGhe.add(new JLabel(\"Vui lòng chọn Toa.\"));\n                pnlSoDoGhe.revalidate();\n                pnlSoDoGhe.repaint();\n            }\n\n            maChuyenTauHienTai = maChuyenTauMoi;\n            hienThiDanhSachToaTau(maTau);\n        }\n    }\n\n    @Override public void mousePressed(MouseEvent e) { }\n    @Override public void mouseReleased(MouseEvent e) { }\n    @Override public void mouseEntered(MouseEvent e) { }\n    @Override public void mouseExited(MouseEvent e) { }\n\n\n\n    @Override\n    public void actionPerformed(ActionEvent e) {\n        Object src = e.getSource();\n        if(src == btnTimChuyen){\n            timKiemChuyenTau();\n        }\n\n        else if (src == cancelButton) {\n            int confirm = JOptionPane.showConfirmDialog(this,\n                    \"Bạn có muốn hủy toàn bộ dữ liệu và quay về Trang chủ?\",\n                    \"Xác nhận\", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);\n            if (confirm != JOptionPane.YES_OPTION) return;\n\n            resetAllData();\n\n            Window w = SwingUtilities.getWindowAncestor(this);\n\n            if (w instanceof BanVeDashboard) {\n                BanVeDashboard dashboard = (BanVeDashboard) w;\n\n                ManHinhTrangChuNVBanVe confirmPanel = new ManHinhTrangChuNVBanVe();\n\n                dashboard.addOrUpdateCard(confirmPanel, \"trangChu\");\n                dashboard.switchToCard(\"trangChu\");\n\n            } else {\n                JOptionPane.showMessageDialog(this,\n                        \"Không thể tìm thấy cửa sổ Dashboard. Vui lòng chạy ứng dụng từ BanVeDashboard.\",\n                        \"Lỗi Hệ thống\", JOptionPane.ERROR_MESSAGE);\n            }\n\n        } else if (src == nextButton) {\n            xuLyNutTiepTheo();\n        }\n    }\n\n    // Sửa đổi phương thức xuLyNutTiepTheo\n    private void xuLyNutTiepTheo() {\n        // SỬA: Lấy tổng số khách yêu cầu từ trường nhập tổng duy nhất\n        int required = parseTextFieldToInt(txtTongSoKhach);\n\n        if (required <= 0) {\n            JOptionPane.showMessageDialog(this,\n                    \"Vui lòng chọn số lượng khách hợp lệ.\",\n                    \"Lỗi\", JOptionPane.WARNING_MESSAGE);\n            return;\n        }\n\n        // Kiểm tra số ghế đã chọn có khớp với yêu cầu không\n        if (danhSachGheDaChon.size() != required) {\n            JOptionPane.showMessageDialog(this,\n                    \"Số ghế đã chọn (\" + danhSachGheDaChon.size() + \") không khớp với Tổng số khách (\" + required + \").\",\n                    \"Lỗi\", JOptionPane.WARNING_MESSAGE);\n            return;\n        }\n\n        // Bổ sung: Kiểm tra thông tin khách hàng bắt buộc (Họ tên, CCCD)\n        for (ChiTietKhach khach : danhSachKhachHang.values()) {\n            // CẬP NHẬT: Sử dụng accessor methods (hoTen(), cccd()) của Record\n            if (khach.hoTen() == null || khach.hoTen().trim().isEmpty() ||\n                    khach.cccd() == null || khach.cccd().trim().isEmpty()) {\n\n                JOptionPane.showMessageDialog(this,\n                        \"Vui lòng nhập đầy đủ Họ tên và CCCD cho tất cả \" + required + \" khách hàng.\",\n                        \"Lỗi\", JOptionPane.WARNING_MESSAGE);\n                return;\n            }\n        }\n\n\n        // --- Logic chuyển màn hình (Giữ nguyên) ---\n        Window w = SwingUtilities.getWindowAncestor(this);\n\n        if (w instanceof BanVeDashboard) {\n            BanVeDashboard dashboard = (BanVeDashboard) w;\n\n            ManHinhXacNhanBanVe confirmPanel = new ManHinhXacNhanBanVe(\n                    danhSachGheDaChon,\n                    danhSachKhachHang,\n                    maChuyenTauHienTai,\n                    date,\n                    new HashMap<>(danhSachGiaVe) // pass a defensive copy of prices\n            );\n\n            dashboard.addOrUpdateCard(confirmPanel, \"xacNhanBanVe\");\n            dashboard.switchToCard(\"xacNhanBanVe\");\n\n        } else {\n            JOptionPane.showMessageDialog(this,\n                    \"Không thể tìm thấy cửa sổ Dashboard. Vui lòng chạy ứng dụng từ BanVeDashboard.\",\n                    \"Lỗi Hệ thống\", JOptionPane.ERROR_MESSAGE);\n        }\n    }\n\n    // ====================\n    // MODULE: Main (để chạy độc lập)\n    // ====================\n    public static void main(String[] args) {\n        SwingUtilities.invokeLater(() -> {\n            JFrame frame = new JFrame(\"Panel Bán vé (Kiểm tra)\");\n            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n            frame.setLayout(new BorderLayout());\n            frame.add(new ManHinhBanVe(), BorderLayout.CENTER);\n            frame.pack();\n            frame.setSize(1200, 850);\n            frame.setLocationRelativeTo(null);\n            frame.setVisible(true);\n        });\n    }\n\n    // ====================\n    // MODULE: Giá vé helpers\n    // ====================\n    private long roundUpToNextTen(long value) {\n        return ((value + 9) / 10) * 10;\n    }\n\n    private long computeTicketPrice(ChoDat cho, String maLoaiVe) throws Exception {\n        Ga gaDi = (Ga) cbGaDi.getSelectedItem();\n        Ga gaDen = (Ga) cbGaDen.getSelectedItem();\n        if (gaDi == null || gaDen == null) throw new Exception(\"Ga đi hoặc ga đến chưa được chọn.\");\n\n        long base = giaVeCoBanDAO.getGiaCoBan(gaDi.getMaGa(), gaDen.getMaGa());\n        if (base <= 0) throw new Exception(\"Không tìm thấy giá cơ bản cho cặp ga.\");\n\n        // Lấy loại toa từ ToaDAO bằng cách lấy danh sách toa của tàu hiện tại rồi tìm maToa\n        ToaDAO tdao = new ToaDAO();\n        String maTau = null;\n        if (maChuyenTauHienTai != null) {\n            for (ChuyenTau ct : ketQua) {\n                if (maChuyenTauHienTai.equals(ct.getMaChuyenTau())) {\n                    maTau = ct.getMaTau();\n                    break;\n                }\n            }\n        }\n        if (maTau == null) throw new Exception(\"Không xác định được mã tàu để tra loại toa.\");\n\n        List<Toa> toas = tdao.layToaTheoMaTau(maTau);\n        String loaiToa = null;\n        if (toas != null) {\n            for (Toa t : toas) {\n                if (t.getMaToa().equals(cho.getMaToa())) {\n                    loaiToa = t.getLoaiToa();\n                    break;\n                }\n            }\n        }\n        if (loaiToa == null) throw new Exception(\"Không tìm thấy thông tin loại toa cho ghế.\");\n\n        double heSoToa = loaiChoDatDAO.getHeSoByLoaiToa(loaiToa);\n        double heSoLoaiVe = loaiVeDAO.getHeSoByMaLoaiVe(maLoaiVe);\n\n        double price = base * heSoToa * heSoLoaiVe;\n        long rounded = roundUpToNextTen(Math.round(price));\n        return rounded;\n    }\n\n    private void capNhatTongTienUI() {\n        long total = 0L;\n        for (Long v : danhSachGiaVe.values()) total += v == null ? 0L : v;\n        lblTotalPrice.setText(\"Tổng tiền vé: \" + formatVnd(total));\n    }\n\n    private String formatVnd(long amount) {\n        try {\n            java.text.NumberFormat nf = java.text.NumberFormat.getInstance(new Locale(\"vi\", \"VN\"));\n            return nf.format(amount) + \" VNĐ\";\n        } catch (Exception e) {\n            return amount + \" VNĐ\";\n        }\n    }\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/gui/Panel/ManHinhBanVe.java b/src/gui/Panel/ManHinhBanVe.java
--- a/src/gui/Panel/ManHinhBanVe.java	(revision 9793dc6c8edd8e1d6bc907354e30a7993a07fe24)
+++ b/src/gui/Panel/ManHinhBanVe.java	(date 1761494060625)
@@ -895,8 +895,8 @@
             return;
         }
 
-        String maGaDi = gaDiSelected.getMaGa();
-        String maGaDen = gaDenSelected.getMaGa();
+        String tenGaDi = gaDiSelected.getTenGa(); //Sửa tối 26/10
+        String tenGaDen = gaDenSelected.getTenGa();//Sửa tôí 26/10
         String ngayDiString = dateField.getText();
         String ngayDiSQL;
         try {
@@ -908,7 +908,7 @@
         }
 
         ChuyenTauDao dao = new ChuyenTauDao();
-        ketQua = dao.timChuyenTau(maGaDi, maGaDen, ngayDiSQL);
+        ketQua = dao.timChuyenTau(tenGaDi, tenGaDen, ngayDiSQL); //Sửa tối 26/10
 
         if (ketQua == null || ketQua.isEmpty()) {
             JOptionPane.showMessageDialog(null, "Không tìm thấy chuyến tàu nào phù hợp.", "Thông báo", JOptionPane.INFORMATION_MESSAGE);
Index: src/database/ConnectDB.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package database;\n\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.SQLException;\n\npublic class ConnectDB {\n    public static Connection con = null;\n    private static ConnectDB instance = new ConnectDB();\n\n    public static ConnectDB getInstance() {\n        return instance;\n    }\n\n    public void connect() {\n        // CẦN SỬA ĐỔI: Kiểm tra xem có nên tạo lại kết nối hay không.\n        boolean isConnectionValid = false;\n        try {\n            if (con != null && !con.isClosed()) {\n                isConnectionValid = true;\n            }\n        } catch (SQLException e) {\n            // Nếu kiểm tra isClosed() ném lỗi, kết nối đã chết và cần tạo lại.\n            isConnectionValid = false;\n        }\n\n        if(!isConnectionValid) {\n            // Logic tạo kết nối chỉ chạy khi kết nối là NULL hoặc không hợp lệ/đã đóng\n            String url = \"jdbc:sqlserver://localhost:1433;databaseName=QuanLyVeTauTest;trustServerCertificate=true\";\n            String user = \"sa\";\n            String password = \"sapassword\";\n            try {\n                con = DriverManager.getConnection(url, user, password);\n            } catch (SQLException e) {\n                System.out.println(\"Kết nối chưa được thiết lập. Đang thực hiện kết nối...\");\n                e.printStackTrace();\n                con = null; // Đảm bảo con là null nếu thất bại\n            }\n        }\n    }\n\n    public static void disconnect() {\n        if(con != null)\n            try {\n                con.close();\n                con = null;\n                System.out.println(\"Đã ngắt kết nối!\");\n            } catch (SQLException e) {\n                e.printStackTrace();\n            }\n    }\n\n    // Phương thức này đã đúng và gọi connect() khi cần thiết\n    public static Connection getConnection() throws SQLException {\n        if (con == null || con.isClosed()) { // Kiểm tra trạng thái hiện tại\n            getInstance().connect();\n            if (con == null){\n                throw new SQLException(\"Failed to establish a database connection.\");\n            }\n        }\n        return con;\n    }\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/database/ConnectDB.java b/src/database/ConnectDB.java
--- a/src/database/ConnectDB.java	(revision 9793dc6c8edd8e1d6bc907354e30a7993a07fe24)
+++ b/src/database/ConnectDB.java	(date 1761490082006)
@@ -26,9 +26,9 @@
 
         if(!isConnectionValid) {
             // Logic tạo kết nối chỉ chạy khi kết nối là NULL hoặc không hợp lệ/đã đóng
-            String url = "jdbc:sqlserver://localhost:1433;databaseName=QuanLyVeTauTest;trustServerCertificate=true";
+            String url = "jdbc:sqlserver://localhost:1433;databaseName=QuanLyVeTauTest2;trustServerCertificate=true";
             String user = "sa";
-            String password = "sapassword";
+            String password = "Sapassword123@";
             try {
                 con = DriverManager.getConnection(url, user, password);
             } catch (SQLException e) {
Index: src/dao/ChuyenTauDao.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\npackage dao;\n\nimport java.sql.*;\nimport java.time.LocalDate;\nimport java.time.LocalTime;\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport entity.ChuyenTau;\nimport entity.Ga;\nimport entity.NhanVien;\nimport entity.Tau;\nimport database.ConnectDB;\nimport entity.lopEnum.TrangThaiChuyenTau;\n\npublic class ChuyenTauDao {\n    private ArrayList<ChuyenTau> danhSachChuyenTau;\n\n    public ChuyenTauDao() {\n        danhSachChuyenTau = new ArrayList<ChuyenTau>();\n    }\n\n    public List<ChuyenTau> timChuyenTau(String gaXP, String gaKT, String ngayDi) {\n        List<ChuyenTau> danhSachChuyenTau = new ArrayList<>();\n        // Định dạng ngày: SQL Server thường dùng yyyy-MM-dd. Đổi \"30/09/2025\" thành \"2025-09-30\"\n\n        String sql = \"SELECT * FROM ChuyenTau WHERE MaGaKhoiHanh = ? AND MaGaDen = ? AND NgayKhoiHanh = ?\";\n\n        try {\n            Connection con = ConnectDB.getConnection();\n            try (PreparedStatement pstmt = con.prepareStatement(sql)) {\n                pstmt.setString(1, gaXP);\n                pstmt.setString(2, gaKT);\n                pstmt.setString(3, ngayDi); // Đã format lại\n                try (ResultSet rs = pstmt.executeQuery()) {\n                    while (rs.next()) {\n                        String maChuyenTau = rs.getString(\"MaChuyenTau\");\n                        String maTau = rs.getString(\"MaTau\");\n                        String maNV = rs.getString(\"MaNV\");\n                        String maGaDiDb = rs.getString(\"MaGaKhoiHanh\");\n                        String maGaDenDb = rs.getString(\"MaGaDen\");\n                        LocalDate ngayKH = rs.getDate(\"NgayKhoiHanh\").toLocalDate();\n                        LocalTime gioKH = rs.getTime(\"GioKhoiHanh\").toLocalTime();\n                        LocalDate ngayDen = rs.getDate(\"NgayDenDuKien\").toLocalDate();\n                        LocalTime gioDen = rs.getTime(\"GioDenDuKien\").toLocalTime();\n                        String trangThai = rs.getString(\"TrangThai\");\n\n                        TrangThaiChuyenTau tt = TrangThaiChuyenTau.fromString(trangThai);\n\n                        Ga gaDi = GaDao.getGaById(maGaDiDb);\n                        Ga gaDen = GaDao.getGaById(maGaDenDb);\n                        Tau tau = TauDAO.getTauById(maTau);\n                        NhanVien nv = NhanVienDao.getNhanVienById(maNV);\n\n                        ChuyenTau ct = new ChuyenTau(maChuyenTau, maTau, ngayKH, gioKH, gaDi, gaDen, tau, ngayDen, gioDen, nv, tt);\n                        danhSachChuyenTau.add(ct);\n                    }\n                }\n            }// PreparedStatement is closed here\n        } catch (SQLException e) {\n            System.err.println(\"Lỗi khi tìm chuyến tàu: \");\n            e.printStackTrace();\n        }\n        return danhSachChuyenTau;\n    }\n\n    public boolean chuyenTrangThaiChuyenTau(String maChuyenTau, String trangThai) {\n        String sql = \"UPDATE ChuyenTau SET TrangThai = ? WHERE MaChuyenTau = ?\";\n        try (Connection con = ConnectDB.getInstance().getConnection();\n             PreparedStatement stmt = con.prepareStatement(sql)) {\n\n            stmt.setString(1, trangThai);\n            stmt.setString(2, maChuyenTau);\n\n            int rows = stmt.executeUpdate();\n            if (rows > 0) {\n                if (this.danhSachChuyenTau != null) {\n                    for (ChuyenTau ct : this.danhSachChuyenTau) {\n                        if (ct.getMaChuyenTau().equals(maChuyenTau)) {\n                            // assuming setter exists\n                            ct.setThct(TrangThaiChuyenTau.valueOf(trangThai));\n                            break;\n                        }\n                    }\n                }\n                return true;\n            }\n        } catch (SQLException e) {\n            e.printStackTrace();\n        }\n        return false;\n    }\n\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/dao/ChuyenTauDao.java b/src/dao/ChuyenTauDao.java
--- a/src/dao/ChuyenTauDao.java	(revision 9793dc6c8edd8e1d6bc907354e30a7993a07fe24)
+++ b/src/dao/ChuyenTauDao.java	(date 1761494874666)
@@ -25,7 +25,7 @@
         List<ChuyenTau> danhSachChuyenTau = new ArrayList<>();
         // Định dạng ngày: SQL Server thường dùng yyyy-MM-dd. Đổi "30/09/2025" thành "2025-09-30"
 
-        String sql = "SELECT * FROM ChuyenTau WHERE MaGaKhoiHanh = ? AND MaGaDen = ? AND NgayKhoiHanh = ?";
+        String sql = "SELECT * FROM ChuyenTau WHERE GaDi = ? AND GaDen = ? AND NgayKhoiHanh = ?";
 
         try {
             Connection con = ConnectDB.getConnection();
@@ -38,8 +38,8 @@
                         String maChuyenTau = rs.getString("MaChuyenTau");
                         String maTau = rs.getString("MaTau");
                         String maNV = rs.getString("MaNV");
-                        String maGaDiDb = rs.getString("MaGaKhoiHanh");
-                        String maGaDenDb = rs.getString("MaGaDen");
+                        String maGaDiDb = rs.getString("GaDi");
+                        String maGaDenDb = rs.getString("GaDen");
                         LocalDate ngayKH = rs.getDate("NgayKhoiHanh").toLocalDate();
                         LocalTime gioKH = rs.getTime("GioKhoiHanh").toLocalTime();
                         LocalDate ngayDen = rs.getDate("NgayDenDuKien").toLocalDate();
@@ -50,10 +50,10 @@
 
                         Ga gaDi = GaDao.getGaById(maGaDiDb);
                         Ga gaDen = GaDao.getGaById(maGaDenDb);
-                        Tau tau = TauDAO.getTauById(maTau);
+                        Tau tau = TauDAO.getTauById(maTau); //Sửa ở đây
                         NhanVien nv = NhanVienDao.getNhanVienById(maNV);
 
-                        ChuyenTau ct = new ChuyenTau(maChuyenTau, maTau, ngayKH, gioKH, gaDi, gaDen, tau, ngayDen, gioDen, nv, tt);
+                        ChuyenTau ct = new ChuyenTau(maChuyenTau, maTau, ngayKH, gioKH, gaDi, gaDen, tau, ngayDen, gioDen, nv, tt); //Sửa ở đây
                         danhSachChuyenTau.add(ct);
                     }
                 }
@@ -62,6 +62,7 @@
             System.err.println("Lỗi khi tìm chuyến tàu: ");
             e.printStackTrace();
         }
+
         return danhSachChuyenTau;
     }
 
Index: src/gui/Panel/ManHinhTraCuuHoaDon.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package gui.Panel; // <-- Make sure this package name is correct\n\n// AWT Imports (Graphics, Layouts, Events)\nimport java.awt.Color;\nimport java.awt.Component;\nimport java.awt.Dimension;\nimport java.awt.Font;\nimport java.awt.Graphics;\nimport java.awt.Graphics2D;\nimport java.awt.GridBagLayout;\nimport java.awt.Point; // Added for evt.getPoint()\nimport java.awt.RenderingHints;\nimport java.awt.event.ActionEvent;\nimport java.awt.event.ActionListener;\nimport java.awt.event.MouseAdapter;\nimport java.awt.event.MouseEvent;\n\n// Swing Imports (Components & Utilities)\nimport javax.swing.BorderFactory;\nimport javax.swing.DefaultComboBoxModel;\nimport javax.swing.GroupLayout;\nimport javax.swing.ImageIcon;\nimport javax.swing.JButton;\nimport javax.swing.JComboBox;\nimport javax.swing.JFrame;\nimport javax.swing.JLabel;\nimport javax.swing.JPanel;\nimport javax.swing.JScrollPane;\nimport javax.swing.JTable;\nimport javax.swing.JTextField;\nimport javax.swing.LayoutStyle;\nimport javax.swing.SwingConstants;\nimport javax.swing.SwingUtilities;\nimport javax.swing.UIManager;\nimport javax.swing.UnsupportedLookAndFeelException; // Added for LookAndFeel catch\n\n// Swing Border Imports\nimport javax.swing.border.BevelBorder;\nimport javax.swing.border.SoftBevelBorder;\n\n// Swing Table Imports\nimport javax.swing.table.DefaultTableCellRenderer;\nimport javax.swing.table.DefaultTableModel;\nimport javax.swing.table.JTableHeader;\nimport javax.swing.table.TableColumnModel;\n\n// Ghi chú: Đã xóa \"import javax.swing.*;\"\n\n/**\n *\n * @author TranSon-Code\n */\npublic class ManHinhTraCuuHoaDon extends JPanel {\n\n\n    // Variables declaration - do not modify\n    private JButton btnFilter, btn_LamMoi, btn_TraCuu, btn_Xoa;\n    private JComboBox<String> ComboBox_DanhMucTimKiem, comboBox_Month, comboBox_Year;\n    private JLabel btnKetQuaTimKiem, lblDanhMucTimKiem, lblNhapNam, lblNhapThang, lblNhapThongTin, lblThongBaoKetQua, lblThongTinTraCuu, lblTieuDeLocTG;\n    private JScrollPane jScrollPane1;\n    private JTable Table_DanhSachHoaDon;\n    private JTextField txt_NhapThongTin;\n\n\n\n    // End of variables declaration\n    /**\n     * Creates new form ManHinhTraCuuHoaDon\n     */\n    public ManHinhTraCuuHoaDon() {\n        initComponents();\n\n        JTableHeader header = Table_DanhSachHoaDon.getTableHeader();\n\n        header.setBorder(BorderFactory.createEmptyBorder());\n        ((DefaultTableCellRenderer) header.getDefaultRenderer()).setBorder(BorderFactory.createEmptyBorder());\n        header.setBackground(new Color(230, 230, 230));\n        header.setForeground(Color.BLACK);\n        header.setFont(new Font(\"Helvetica Neue\", Font.BOLD, 14));\n        Dimension newSize = new Dimension(163, 50);\n\n        comboBox_Year.setPreferredSize(newSize);\n        comboBox_Year.setMinimumSize(newSize);\n        comboBox_Year.setMaximumSize(newSize);\n        DefaultTableCellRenderer renderer = (DefaultTableCellRenderer) Table_DanhSachHoaDon.getDefaultRenderer(Object.class);\n        renderer.setVerticalAlignment(SwingConstants.TOP);\n\n        DefaultTableCellRenderer headerRenderer = (DefaultTableCellRenderer) Table_DanhSachHoaDon.getTableHeader().getDefaultRenderer();\n        headerRenderer.setHorizontalAlignment(SwingConstants.CENTER);\n        TableColumnModel columnModel = Table_DanhSachHoaDon.getColumnModel();\n        columnModel.getColumn(0).setPreferredWidth(150); // Cột 0 - Mã hóa đơn\n        columnModel.getColumn(1).setPreferredWidth(200); // Cột 1 - Khách hàng\n\n        DefaultTableCellRenderer centerDataRenderer = new DefaultTableCellRenderer();\n        centerDataRenderer.setHorizontalAlignment(SwingConstants.CENTER);\n        centerDataRenderer.setVerticalAlignment(SwingConstants.TOP); // Giữ lại căn lề trên\n\n        columnModel.getColumn(2).setCellRenderer(centerDataRenderer); // Cột Tuyến\n        columnModel.getColumn(3).setCellRenderer(centerDataRenderer); // Cột Số lượng vé\n        columnModel.getColumn(4).setCellRenderer(centerDataRenderer); // Cột Ngày khởi hành\n        columnModel.getColumn(5).setCellRenderer(centerDataRenderer); // Cột Tổng tiền\n\n        // Custom cho cột tùy chọn\n        DefaultTableCellRenderer linkRenderer = new DefaultTableCellRenderer() {\n            @Override\n            public Component getTableCellRendererComponent(JTable table, Object value,\n                                                           boolean isSelected, boolean hasFocus, int row, int column) {\n\n                Component c = super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);\n                if (value != null) {\n                    setText(\"<html><u>\" + value.toString() + \"</u></html>\");\n                }\n                setForeground(Color.BLUE);\n                setVerticalAlignment(SwingConstants.TOP);\n                setHorizontalAlignment(SwingConstants.CENTER);\n                return c;\n            }\n        };\n        Table_DanhSachHoaDon.getColumnModel().getColumn(6).setCellRenderer(linkRenderer);\n\n        // THÊM SỰ KIỆN CHO CỘT TÙY CHỌN ĐỂ HIỂN THỊ CHI TIẾT HÓA ĐƠN\n        Table_DanhSachHoaDon.addMouseListener(new MouseAdapter() {\n            @Override\n            public void mouseClicked(MouseEvent evt) {\n                int row = Table_DanhSachHoaDon.rowAtPoint(evt.getPoint());\n                int col = Table_DanhSachHoaDon.columnAtPoint(evt.getPoint());\n\n                if (col == 6 && row >= 0) {\n                    Object maHoaDonObj = Table_DanhSachHoaDon.getValueAt(row, 0);\n                    String maHoaDon = (maHoaDonObj != null) ? maHoaDonObj.toString() : \"N/A\";\n                    showChiTietPopup(maHoaDon);\n                }\n            }\n        });\n    }\n    // --- KẾT THÚC CODE THÊM SỰ KIỆN ---\n\n    /**\n     * This method is called from within the constructor to initialize the form.\n     * WARNING: Do NOT modify this code. The content of this method is always\n     * regenerated by the Form Editor.\n     */\n    @SuppressWarnings(\"unchecked\")\n    // <editor-fold defaultstate=\"collapsed\" desc=\"Generated Code\">\n    private void initComponents() {\n\n        lblTieuDeLocTG = new JLabel();\n        lblNhapThang = new JLabel();\n        ComboBox_DanhMucTimKiem = new JComboBox<>();\n        lblThongTinTraCuu = new JLabel();\n        txt_NhapThongTin = new JTextField();\n        btn_TraCuu = new JButton();\n        lblNhapThongTin = new JLabel();\n        lblDanhMucTimKiem = new JLabel();\n        comboBox_Month = new JComboBox<>();\n        lblNhapNam = new JLabel();\n        btnKetQuaTimKiem = new JLabel();\n        lblThongBaoKetQua = new JLabel() {\n            {\n                setOpaque(false);\n            }\n\n            @Override\n            protected void paintComponent(Graphics g) {\n                Graphics2D g2 = (Graphics2D) g.create();\n                g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);\n                g2.setColor(getBackground());\n                g2.fillRoundRect(0, 0, getWidth(), getHeight(), 15, 15);\n                g2.dispose();\n                super.paintComponent(g);\n            }\n        };\n        jScrollPane1 = new JScrollPane();\n        Table_DanhSachHoaDon = new JTable();\n        btnFilter = new JButton();\n        comboBox_Year = new JComboBox<>();\n        btn_Xoa = new JButton();\n        btn_LamMoi = new JButton();\n\n        lblTieuDeLocTG.setFont(new Font(\"Helvetica Neue\", Font.PLAIN, 28)); // NOI18N\n        lblTieuDeLocTG.setText(\"Tìm kiếm theo thời gian\");\n\n        lblNhapThang.setFont(new Font(\"Helvetica Neue\", Font.BOLD, 16)); // NOI18N\n        lblNhapThang.setText(\"Tháng \");\n\n        ComboBox_DanhMucTimKiem.setBackground(new Color(220, 222, 221));\n        ComboBox_DanhMucTimKiem.setFont(new Font(\"Helvetica Neue\", Font.PLAIN, 18)); // NOI18N\n        ComboBox_DanhMucTimKiem.setForeground(new Color(102, 102, 102));\n        ComboBox_DanhMucTimKiem.setModel(new DefaultComboBoxModel<>(new String[] { \"Số điện thoại\", \"Số CCCD\", \"Mã hóa đơn\" }));\n        ComboBox_DanhMucTimKiem.setMinimumSize(new Dimension(124, 100));\n        ComboBox_DanhMucTimKiem.setPreferredSize(new Dimension(133, 50));\n        ComboBox_DanhMucTimKiem.addActionListener(new ActionListener() {\n            public void actionPerformed(ActionEvent evt) {\n                ComboBox_DanhMucTimKiemActionPerformed(evt);\n            }\n        });\n\n        lblThongTinTraCuu.setFont(new Font(\"Helvetica Neue\", Font.BOLD, 18)); // NOI18N\n        lblThongTinTraCuu.setText(\"Thông tin tra cứu \");\n\n        txt_NhapThongTin.setBackground(new Color(220, 222, 221));\n        txt_NhapThongTin.setFont(new Font(\"Helvetica Neue\", Font.PLAIN, 18)); // NOI18N\n        txt_NhapThongTin.setForeground(new Color(102, 102, 102));\n        txt_NhapThongTin.setText(\"VD : 0123456789\");\n        txt_NhapThongTin.setMinimumSize(new Dimension(124, 40));\n        txt_NhapThongTin.addActionListener(new ActionListener() {\n            public void actionPerformed(ActionEvent evt) {\n                txt_NhapThongTinActionPerformed(evt);\n            }\n        });\n\n        btn_TraCuu.setBackground(new Color(0, 102, 255));\n        btn_TraCuu.setFont(new Font(\"Helvetica Neue\", Font.PLAIN, 16)); // NOI18N\n        btn_TraCuu.setForeground(new Color(255, 255, 255));\n        btn_TraCuu.setText(\"Tra cứu\");\n        btn_TraCuu.setBorder(new SoftBevelBorder(BevelBorder.RAISED));\n        btn_TraCuu.setBorderPainted(false);\n        btn_TraCuu.setOpaque(true);\n        btn_TraCuu.addActionListener(new ActionListener() {\n            public void actionPerformed(ActionEvent evt) {\n                btn_TraCuuActionPerformed(evt);\n            }\n        });\n\n        lblNhapThongTin.setFont(new Font(\"Helvetica Neue\", Font.PLAIN, 28)); // NOI18N\n        lblNhapThongTin.setText(\"Nhập thông tin tra cứu hóa đơn\");\n\n        lblDanhMucTimKiem.setFont(new Font(\"Helvetica Neue\", Font.BOLD, 18)); // NOI18N\n        lblDanhMucTimKiem.setText(\"Tìm kiếm theo \");\n\n        comboBox_Month.setBackground(new Color(220, 222, 221));\n        comboBox_Month.setFont(new Font(\"Helvetica Neue\", Font.PLAIN, 18)); // NOI18N\n        comboBox_Month.setModel(new DefaultComboBoxModel<>(new String[] { \"<html><br><html>\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\", \" \" }));\n        comboBox_Month.setMinimumSize(new Dimension(72, 50));\n        comboBox_Month.addActionListener(new ActionListener() {\n            public void actionPerformed(ActionEvent evt) {\n                comboBox_MonthActionPerformed(evt);\n            }\n        });\n\n        lblNhapNam.setFont(new Font(\"Helvetica Neue\", Font.BOLD, 16)); // NOI18N\n        lblNhapNam.setText(\"Năm\");\n\n        btnKetQuaTimKiem.setFont(new Font(\"Apple Braille\", Font.PLAIN, 26)); // NOI18N\n        btnKetQuaTimKiem.setText(\"Kết quả tìm kiếm\");\n\n        lblThongBaoKetQua.setBackground(new Color(0, 204, 102));\n        lblThongBaoKetQua.setFont(new Font(\"Helvetica Neue\", Font.BOLD, 14)); // NOI18N\n        lblThongBaoKetQua.setForeground(new Color(255, 255, 255));\n        lblThongBaoKetQua.setHorizontalAlignment(SwingConstants.CENTER);\n        lblThongBaoKetQua.setText(\"2 hóa đơn\");\n\n        Table_DanhSachHoaDon.setFont(new Font(\"Helvetica Neue\", Font.PLAIN, 16)); // NOI18N\n        Table_DanhSachHoaDon.setModel(new DefaultTableModel(\n                new Object [][] {\n                        {\"HD2109202400010005\", \"<html>Nguyễn Văn Nam<br>0123456789</html>\", \"Sài Gòn - Hà Nội\", \"3\", \"<html>21-09-2024<br>08:30<html>\", \"2.420.000đ\", \"Xem\"},\n                        {\"HD1901202400080436\", \"<html>Nguyễn Văn Nam<br>0123456789</html>\", \"Sài Gòn - Đà Nẵng\", \"2\", \"<html>10-01-2024<br>17:25</html>\", \"1.850.000đ\", \"Xem\"},\n                        {null, null, null, null, \"\", null, null}\n                },\n                new String [] {\n                        \"Mã hóa đơn\", \"Khách hàng\", \"Tuyến\", \"Số lượng vé\", \"Ngày khởi hành\", \"Tổng tiền\", \"Tùy chọn\"\n                }\n        ) {\n            Class[] types = new Class [] {\n                    String.class, String.class, String.class, String.class, Object.class, String.class, Object.class\n            };\n\n            @Override\n            public Class getColumnClass(int columnIndex) {\n                return types [columnIndex];\n            }\n        });\n        Table_DanhSachHoaDon.setRowHeight(60);\n        jScrollPane1.setViewportView(Table_DanhSachHoaDon);\n\n        btnFilter.setBackground(new Color(0, 102, 255));\n        btnFilter.setFont(new Font(\"Helvetica Neue\", Font.PLAIN, 16)); // NOI18N\n        btnFilter.setForeground(new Color(255, 255, 255));\n        btnFilter.setText(\"Lọc\");\n        btnFilter.setBorder(new SoftBevelBorder(BevelBorder.RAISED));\n        btnFilter.setBorderPainted(false);\n        btnFilter.setOpaque(true);\n        btnFilter.setPreferredSize(new Dimension(33, 50));\n        btnFilter.addActionListener(new ActionListener() {\n            public void actionPerformed(ActionEvent evt) {\n                btnFilterActionPerformed(evt);\n            }\n        });\n\n        comboBox_Year.setBackground(new Color(220, 222, 221));\n        comboBox_Year.setFont(new Font(\"Helvetica Neue\", Font.PLAIN, 18)); // NOI18N\n        comboBox_Year.setModel(new DefaultComboBoxModel<>(new String[] { \"<html><br></html>\", \"2020\", \"2021\", \"2022\", \"2023\", \"2024\", \"2025\" }));\n        comboBox_Year.setMinimumSize(new Dimension(72, 50));\n        comboBox_Year.setPreferredSize(new Dimension(74, 50));\n        comboBox_Year.setSize(new Dimension(20, 20));\n\n        btn_Xoa.setBackground(new Color(255, 0, 51));\n        btn_Xoa.setFont(new Font(\"Helvetica Neue\", Font.PLAIN, 16)); // NOI18N\n        btn_Xoa.setForeground(new Color(255, 255, 255));\n        btn_Xoa.setText(\"Xóa\");\n        btn_Xoa.setBorder(new SoftBevelBorder(BevelBorder.RAISED));\n        btn_Xoa.setBorderPainted(false);\n        btn_Xoa.setOpaque(true);\n        btn_Xoa.addActionListener(new ActionListener() {\n            public void actionPerformed(ActionEvent evt) {\n                btn_XoaActionPerformed(evt);\n            }\n        });\n\n        btn_LamMoi.setBackground(new Color(255, 153, 0));\n        btn_LamMoi.setForeground(new Color(255, 255, 255));\n        btn_LamMoi.setText(\"Làm mới\");\n        btn_LamMoi.addActionListener(new ActionListener() {\n            public void actionPerformed(ActionEvent evt) {\n                btn_LamMoiActionPerformed(evt);\n            }\n        });\n\n        GroupLayout layout = new GroupLayout(this);\n        this.setLayout(layout);\n        layout.setHorizontalGroup(\n                layout.createParallelGroup(GroupLayout.Alignment.LEADING)\n                        .addGroup(layout.createSequentialGroup()\n                                .addGap(63, 63, 63)\n                                .addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)\n                                        .addGroup(layout.createSequentialGroup()\n                                                .addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)\n                                                        .addGroup(layout.createSequentialGroup()\n                                                                .addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)\n                                                                        .addComponent(ComboBox_DanhMucTimKiem, GroupLayout.PREFERRED_SIZE, 209, GroupLayout.PREFERRED_SIZE)\n                                                                        .addComponent(comboBox_Month, GroupLayout.PREFERRED_SIZE, 212, GroupLayout.PREFERRED_SIZE)\n                                                                        .addGroup(layout.createSequentialGroup()\n                                                                                .addGap(10, 10, 10)\n                                                                                .addComponent(lblDanhMucTimKiem)))\n                                                                .addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)\n                                                                        .addGroup(layout.createSequentialGroup()\n                                                                                .addGap(71, 71, 71)\n                                                                                .addComponent(lblThongTinTraCuu))\n                                                                        .addGroup(layout.createSequentialGroup()\n                                                                                .addGap(58, 58, 58)\n                                                                                .addGroup(layout.createParallelGroup(GroupLayout.Alignment.TRAILING)\n                                                                                        .addGroup(layout.createSequentialGroup()\n                                                                                                .addComponent(comboBox_Year, GroupLayout.PREFERRED_SIZE, 246, GroupLayout.PREFERRED_SIZE)\n                                                                                                .addGap(18, 18, 18)\n                                                                                                .addComponent(btnFilter, GroupLayout.PREFERRED_SIZE, 210, GroupLayout.PREFERRED_SIZE))\n                                                                                        .addComponent(txt_NhapThongTin, GroupLayout.PREFERRED_SIZE, 473, GroupLayout.PREFERRED_SIZE))\n                                                                                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)\n                                                                                .addComponent(btn_TraCuu, GroupLayout.PREFERRED_SIZE, 126, GroupLayout.PREFERRED_SIZE)\n                                                                                .addGap(18, 18, 18)\n                                                                                .addComponent(btn_Xoa, GroupLayout.PREFERRED_SIZE, 59, GroupLayout.PREFERRED_SIZE))))\n                                                        .addComponent(lblNhapThongTin)\n                                                        .addComponent(lblTieuDeLocTG))\n                                                .addContainerGap(74, Short.MAX_VALUE))\n                                        .addGroup(layout.createSequentialGroup()\n                                                .addComponent(btnKetQuaTimKiem)\n                                                .addPreferredGap(LayoutStyle.ComponentPlacement.UNRELATED)\n                                                .addComponent(lblThongBaoKetQua, GroupLayout.PREFERRED_SIZE, 77, GroupLayout.PREFERRED_SIZE)\n                                                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)\n                                                .addComponent(btn_LamMoi)\n                                                .addGap(17, 17, 17))))\n                        .addGroup(layout.createSequentialGroup()\n                                .addGap(73, 73, 73)\n                                .addComponent(lblNhapThang)\n                                .addGap(225, 225, 225)\n                                .addComponent(lblNhapNam)\n                                .addContainerGap(706, Short.MAX_VALUE))\n                        .addGroup(layout.createSequentialGroup()\n                                .addContainerGap()\n                                .addComponent(jScrollPane1)\n                                .addContainerGap())\n        );\n        layout.setVerticalGroup(\n                layout.createParallelGroup(GroupLayout.Alignment.LEADING)\n                        .addGroup(layout.createSequentialGroup()\n                                .addGap(34, 34, 34)\n                                .addComponent(lblNhapThongTin)\n                                .addGap(18, 18, 18)\n                                .addGroup(layout.createParallelGroup(GroupLayout.Alignment.BASELINE)\n                                        .addComponent(lblDanhMucTimKiem)\n                                        .addComponent(lblThongTinTraCuu))\n                                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)\n                                .addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING, false)\n                                        .addGroup(layout.createParallelGroup(GroupLayout.Alignment.BASELINE)\n                                                .addComponent(txt_NhapThongTin, GroupLayout.DEFAULT_SIZE, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)\n                                                .addComponent(btn_TraCuu, GroupLayout.PREFERRED_SIZE, 40, GroupLayout.PREFERRED_SIZE)\n                                                .addComponent(btn_Xoa, GroupLayout.PREFERRED_SIZE, 39, GroupLayout.PREFERRED_SIZE))\n                                        .addComponent(ComboBox_DanhMucTimKiem, GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))\n                                .addGap(22, 22, 22)\n                                .addComponent(lblTieuDeLocTG)\n                                .addGap(18, 18, 18)\n                                .addGroup(layout.createParallelGroup(GroupLayout.Alignment.BASELINE)\n                                        .addComponent(lblNhapThang)\n                                        .addComponent(lblNhapNam))\n                                .addGap(4, 4, 4)\n                                .addGroup(layout.createParallelGroup(GroupLayout.Alignment.BASELINE)\n                                        .addComponent(btnFilter, GroupLayout.PREFERRED_SIZE, 40, GroupLayout.PREFERRED_SIZE)\n                                        .addComponent(comboBox_Year, GroupLayout.DEFAULT_SIZE, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE) // Chỉnh lại nếu cần\n                                        .addComponent(comboBox_Month, GroupLayout.PREFERRED_SIZE, 50, GroupLayout.PREFERRED_SIZE))\n                                .addGap(72, 72, 72)\n                                .addGroup(layout.createParallelGroup(GroupLayout.Alignment.BASELINE)\n                                        .addComponent(btnKetQuaTimKiem)\n                                        .addComponent(lblThongBaoKetQua, GroupLayout.PREFERRED_SIZE, 30, GroupLayout.PREFERRED_SIZE)\n                                        .addComponent(btn_LamMoi))\n                                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)\n                                .addComponent(jScrollPane1, GroupLayout.PREFERRED_SIZE, 242, GroupLayout.PREFERRED_SIZE)\n                                .addContainerGap())\n        );\n    }// </editor-fold>\n\n    private void ComboBox_DanhMucTimKiemActionPerformed(ActionEvent evt) {\n        // TODO add your handling code here:\n    }\n\n    private void btn_TraCuuActionPerformed(ActionEvent evt) {\n        // TODO add your handling code here:\n    }\n\n    private void comboBox_MonthActionPerformed(ActionEvent evt) {\n        // TODO add your handling code here:\n    }\n\n    private void txt_NhapThongTinActionPerformed(ActionEvent evt) {\n        // TODO add your handling code here:\n    }\n\n    private void btnFilterActionPerformed(ActionEvent evt) {\n        // TODO add your handling code here:\n    }\n\n    private void btn_XoaActionPerformed(ActionEvent evt) {\n        // TODO add your handling code here:\n    }\n\n    private void btn_LamMoiActionPerformed(ActionEvent evt) {\n        // TODO add your handling code here:\n    }\n\n    /**\n     * Hiển thị popup chi tiết hóa đơn với hiệu ứng nền mờ (overlay).\n     * @param maHoaDon Mã hóa đơn để hiển thị\n     */\n    private void showChiTietPopup(String maHoaDon) {\n        JFrame topFrame = (JFrame) SwingUtilities.getWindowAncestor(this);\n        if (topFrame == null) {\n            return;\n        }\n\n        PopUpChiTietHoaDon chiTietPanel = new PopUpChiTietHoaDon();\n        // Maybe: chiTietPanel.loadDataByMaHoaDon(maHoaDon);\n\n        JPanel overlayPanel = new JPanel(new GridBagLayout()) {\n            @Override\n            protected void paintComponent(Graphics g) {\n                super.paintComponent(g);\n                g.setColor(new Color(0, 0, 0, 150));\n                g.fillRect(0, 0, getWidth(), getHeight());\n            }\n        };\n        overlayPanel.setOpaque(false);\n        overlayPanel.add(chiTietPanel);\n\n        topFrame.setGlassPane(overlayPanel);\n        overlayPanel.setVisible(true);\n    }\n\n    public static void main(String[] args) {\n        try {\n            UIManager.setLookAndFeel(\"javax.swing.plaf.nimbus.NimbusLookAndFeel\");\n        } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException e) { // More specific catches\n            e.printStackTrace();\n        }\n        SwingUtilities.invokeLater(() -> {\n            JFrame frame = new JFrame();\n            ManHinhTraCuuHoaDon panel = new ManHinhTraCuuHoaDon();\n            frame.setContentPane(panel);\n            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n            frame.pack();\n            frame.setLocationRelativeTo(null);\n            frame.setVisible(true);\n        });\n    }\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/gui/Panel/ManHinhTraCuuHoaDon.java b/src/gui/Panel/ManHinhTraCuuHoaDon.java
--- a/src/gui/Panel/ManHinhTraCuuHoaDon.java	(revision 9793dc6c8edd8e1d6bc907354e30a7993a07fe24)
+++ b/src/gui/Panel/ManHinhTraCuuHoaDon.java	(date 1761500416242)
@@ -1,6 +1,6 @@
-package gui.Panel; // <-- Make sure this package name is correct
+package gui.Panel; // <-- Đảm bảo tên package đúng
 
-// AWT Imports (Graphics, Layouts, Events)
+// AWT Imports
 import java.awt.Color;
 import java.awt.Component;
 import java.awt.Dimension;
@@ -8,18 +8,16 @@
 import java.awt.Graphics;
 import java.awt.Graphics2D;
 import java.awt.GridBagLayout;
-import java.awt.Point; // Added for evt.getPoint()
 import java.awt.RenderingHints;
 import java.awt.event.ActionEvent;
 import java.awt.event.ActionListener;
 import java.awt.event.MouseAdapter;
 import java.awt.event.MouseEvent;
 
-// Swing Imports (Components & Utilities)
+// Swing Imports
 import javax.swing.BorderFactory;
 import javax.swing.DefaultComboBoxModel;
 import javax.swing.GroupLayout;
-import javax.swing.ImageIcon;
 import javax.swing.JButton;
 import javax.swing.JComboBox;
 import javax.swing.JFrame;
@@ -32,7 +30,7 @@
 import javax.swing.SwingConstants;
 import javax.swing.SwingUtilities;
 import javax.swing.UIManager;
-import javax.swing.UnsupportedLookAndFeelException; // Added for LookAndFeel catch
+import javax.swing.UnsupportedLookAndFeelException;
 
 // Swing Border Imports
 import javax.swing.border.BevelBorder;
@@ -44,15 +42,12 @@
 import javax.swing.table.JTableHeader;
 import javax.swing.table.TableColumnModel;
 
-// Ghi chú: Đã xóa "import javax.swing.*;"
-
 /**
  *
  * @author TranSon-Code
  */
 public class ManHinhTraCuuHoaDon extends JPanel {
 
-
     // Variables declaration - do not modify
     private JButton btnFilter, btn_LamMoi, btn_TraCuu, btn_Xoa;
     private JComboBox<String> ComboBox_DanhMucTimKiem, comboBox_Month, comboBox_Year;
@@ -60,52 +55,77 @@
     private JScrollPane jScrollPane1;
     private JTable Table_DanhSachHoaDon;
     private JTextField txt_NhapThongTin;
-
-
-
     // End of variables declaration
+
     /**
      * Creates new form ManHinhTraCuuHoaDon
      */
     public ManHinhTraCuuHoaDon() {
-        initComponents();
+        initComponents(); // Khởi tạo component từ NetBeans Design
+        customizeComponents(); // Gọi hàm tùy chỉnh giao diện
+        addTableClickListener(); // Gọi hàm thêm sự kiện click bảng
+    }
+
+    /**
+     * Tùy chỉnh giao diện cho các components (ComboBox, Table header, columns...).
+     */
+    private void customizeComponents() {
+        // Tùy chỉnh ComboBox Năm
+        Dimension newSize = new Dimension(163, 50);
+        comboBox_Year.setPreferredSize(newSize);
+        comboBox_Year.setMinimumSize(newSize);
+        comboBox_Year.setMaximumSize(newSize);
 
+        // Tùy chỉnh Header Bảng
+        styleTableHeader();
+
+        // Tùy chỉnh Cột và Renderer của Bảng
+        setupTableColumnsAndRenderers();
+    }
+
+    /**
+     * Tùy chỉnh giao diện cho Header của Bảng.
+     */
+    private void styleTableHeader() {
         JTableHeader header = Table_DanhSachHoaDon.getTableHeader();
-
-        header.setBorder(BorderFactory.createEmptyBorder());
-        ((DefaultTableCellRenderer) header.getDefaultRenderer()).setBorder(BorderFactory.createEmptyBorder());
+        header.setBorder(BorderFactory.createEmptyBorder()); // Tắt viền ngoài
+        ((DefaultTableCellRenderer) header.getDefaultRenderer()).setBorder(BorderFactory.createEmptyBorder()); // Tắt viền ô
         header.setBackground(new Color(230, 230, 230));
         header.setForeground(Color.BLACK);
         header.setFont(new Font("Helvetica Neue", Font.BOLD, 14));
-        Dimension newSize = new Dimension(163, 50);
+        ((DefaultTableCellRenderer) header.getDefaultRenderer()).setHorizontalAlignment(SwingConstants.CENTER); // Căn giữa tiêu đề
+    }
 
-        comboBox_Year.setPreferredSize(newSize);
-        comboBox_Year.setMinimumSize(newSize);
-        comboBox_Year.setMaximumSize(newSize);
-        DefaultTableCellRenderer renderer = (DefaultTableCellRenderer) Table_DanhSachHoaDon.getDefaultRenderer(Object.class);
-        renderer.setVerticalAlignment(SwingConstants.TOP);
+    /**
+     * Tùy chỉnh độ rộng cột và Cell Renderer cho các ô dữ liệu.
+     */
+    private void setupTableColumnsAndRenderers() {
+        // Căn lề TOP mặc định cho tất cả các ô
+        DefaultTableCellRenderer defaultRenderer = (DefaultTableCellRenderer) Table_DanhSachHoaDon.getDefaultRenderer(Object.class);
+        defaultRenderer.setVerticalAlignment(SwingConstants.TOP);
 
-        DefaultTableCellRenderer headerRenderer = (DefaultTableCellRenderer) Table_DanhSachHoaDon.getTableHeader().getDefaultRenderer();
-        headerRenderer.setHorizontalAlignment(SwingConstants.CENTER);
         TableColumnModel columnModel = Table_DanhSachHoaDon.getColumnModel();
-        columnModel.getColumn(0).setPreferredWidth(150); // Cột 0 - Mã hóa đơn
-        columnModel.getColumn(1).setPreferredWidth(200); // Cột 1 - Khách hàng
 
+        // Đặt độ rộng cột
+        columnModel.getColumn(0).setPreferredWidth(150); // Mã hóa đơn
+        columnModel.getColumn(1).setPreferredWidth(200); // Khách hàng
+
+        // Tạo renderer căn giữa dữ liệu
         DefaultTableCellRenderer centerDataRenderer = new DefaultTableCellRenderer();
         centerDataRenderer.setHorizontalAlignment(SwingConstants.CENTER);
-        centerDataRenderer.setVerticalAlignment(SwingConstants.TOP); // Giữ lại căn lề trên
+        centerDataRenderer.setVerticalAlignment(SwingConstants.TOP); // Giữ căn TOP
 
-        columnModel.getColumn(2).setCellRenderer(centerDataRenderer); // Cột Tuyến
-        columnModel.getColumn(3).setCellRenderer(centerDataRenderer); // Cột Số lượng vé
-        columnModel.getColumn(4).setCellRenderer(centerDataRenderer); // Cột Ngày khởi hành
-        columnModel.getColumn(5).setCellRenderer(centerDataRenderer); // Cột Tổng tiền
+        // Áp dụng renderer căn giữa cho các cột cần thiết
+        columnModel.getColumn(2).setCellRenderer(centerDataRenderer); // Tuyến
+        columnModel.getColumn(3).setCellRenderer(centerDataRenderer); // Số lượng vé
+        columnModel.getColumn(4).setCellRenderer(centerDataRenderer); // Ngày khởi hành
+        columnModel.getColumn(5).setCellRenderer(centerDataRenderer); // Tổng tiền
 
-        // Custom cho cột tùy chọn
+        // Tạo renderer kiểu "link" cho cột "Tùy chọn"
         DefaultTableCellRenderer linkRenderer = new DefaultTableCellRenderer() {
             @Override
             public Component getTableCellRendererComponent(JTable table, Object value,
                                                            boolean isSelected, boolean hasFocus, int row, int column) {
-
                 Component c = super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);
                 if (value != null) {
                     setText("<html><u>" + value.toString() + "</u></html>");
@@ -116,24 +136,57 @@
                 return c;
             }
         };
-        Table_DanhSachHoaDon.getColumnModel().getColumn(6).setCellRenderer(linkRenderer);
+        columnModel.getColumn(6).setCellRenderer(linkRenderer); // Áp dụng cho cột 6
+    }
 
-        // THÊM SỰ KIỆN CHO CỘT TÙY CHỌN ĐỂ HIỂN THỊ CHI TIẾT HÓA ĐƠN
+    /**
+     * Thêm sự kiện click chuột vào bảng để hiển thị chi tiết hóa đơn.
+     */
+    private void addTableClickListener() {
         Table_DanhSachHoaDon.addMouseListener(new MouseAdapter() {
             @Override
             public void mouseClicked(MouseEvent evt) {
                 int row = Table_DanhSachHoaDon.rowAtPoint(evt.getPoint());
                 int col = Table_DanhSachHoaDon.columnAtPoint(evt.getPoint());
 
-                if (col == 6 && row >= 0) {
+                if (col == 6 && row >= 0) { // Click vào cột "Tùy chọn"
                     Object maHoaDonObj = Table_DanhSachHoaDon.getValueAt(row, 0);
                     String maHoaDon = (maHoaDonObj != null) ? maHoaDonObj.toString() : "N/A";
-                    showChiTietPopup(maHoaDon);
+                    showChiTietPopup(maHoaDon); // Gọi hàm hiển thị popup
                 }
             }
         });
     }
-    // --- KẾT THÚC CODE THÊM SỰ KIỆN ---
+
+    /**
+     * Hiển thị popup chi tiết hóa đơn với hiệu ứng nền mờ (overlay).
+     * @param maHoaDon Mã hóa đơn để hiển thị (hiện chưa dùng)
+     */
+    private void showChiTietPopup(String maHoaDon) {
+        JFrame topFrame = (JFrame) SwingUtilities.getWindowAncestor(this);
+        if (topFrame == null) return;
+
+        // Tạo panel chi tiết popup
+        PopUpChiTietHoaDon chiTietPanel = new PopUpChiTietHoaDon();
+        // TODO: (Trong tương lai) Truyền maHoaDon vào chiTietPanel để tải đúng dữ liệu
+        // chiTietPanel.loadDataByMaHoaDon(maHoaDon);
+
+        // Tạo panel nền mờ (overlay)
+        JPanel overlayPanel = new JPanel(new GridBagLayout()) {
+            @Override
+            protected void paintComponent(Graphics g) {
+                super.paintComponent(g);
+                g.setColor(new Color(0, 0, 0, 150)); // Màu đen mờ 50%
+                g.fillRect(0, 0, getWidth(), getHeight());
+            }
+        };
+        overlayPanel.setOpaque(false);
+        overlayPanel.add(chiTietPanel); // Đặt popup vào giữa nền mờ
+
+        // Đặt và hiển thị overlay lên Glass Pane của cửa sổ chính
+        topFrame.setGlassPane(overlayPanel);
+        overlayPanel.setVisible(true);
+    }
 
     /**
      * This method is called from within the constructor to initialize the form.
@@ -157,6 +210,7 @@
         btnKetQuaTimKiem = new JLabel();
         lblThongBaoKetQua = new JLabel() {
             {
+                // Tắt chế độ vẽ nền chữ nhật mặc định
                 setOpaque(false);
             }
 
@@ -289,7 +343,7 @@
 
         comboBox_Year.setBackground(new Color(220, 222, 221));
         comboBox_Year.setFont(new Font("Helvetica Neue", Font.PLAIN, 18)); // NOI18N
-        comboBox_Year.setModel(new DefaultComboBoxModel<>(new String[] { "<html><br></html>", "2020", "2021", "2022", "2023", "2024", "2025" }));
+        comboBox_Year.setModel(new DefaultComboBoxModel<>(new String[] { "<html><br><html>", "2020", "2021", "2022", "2023", "2024", "2025" }));
         comboBox_Year.setMinimumSize(new Dimension(72, 50));
         comboBox_Year.setPreferredSize(new Dimension(74, 50));
         comboBox_Year.setSize(new Dimension(20, 20));
@@ -310,11 +364,6 @@
         btn_LamMoi.setBackground(new Color(255, 153, 0));
         btn_LamMoi.setForeground(new Color(255, 255, 255));
         btn_LamMoi.setText("Làm mới");
-        btn_LamMoi.addActionListener(new ActionListener() {
-            public void actionPerformed(ActionEvent evt) {
-                btn_LamMoiActionPerformed(evt);
-            }
-        });
 
         GroupLayout layout = new GroupLayout(this);
         this.setLayout(layout);
@@ -431,42 +480,10 @@
         // TODO add your handling code here:
     }
 
-    private void btn_LamMoiActionPerformed(ActionEvent evt) {
-        // TODO add your handling code here:
-    }
-
-    /**
-     * Hiển thị popup chi tiết hóa đơn với hiệu ứng nền mờ (overlay).
-     * @param maHoaDon Mã hóa đơn để hiển thị
-     */
-    private void showChiTietPopup(String maHoaDon) {
-        JFrame topFrame = (JFrame) SwingUtilities.getWindowAncestor(this);
-        if (topFrame == null) {
-            return;
-        }
-
-        PopUpChiTietHoaDon chiTietPanel = new PopUpChiTietHoaDon();
-        // Maybe: chiTietPanel.loadDataByMaHoaDon(maHoaDon);
-
-        JPanel overlayPanel = new JPanel(new GridBagLayout()) {
-            @Override
-            protected void paintComponent(Graphics g) {
-                super.paintComponent(g);
-                g.setColor(new Color(0, 0, 0, 150));
-                g.fillRect(0, 0, getWidth(), getHeight());
-            }
-        };
-        overlayPanel.setOpaque(false);
-        overlayPanel.add(chiTietPanel);
-
-        topFrame.setGlassPane(overlayPanel);
-        overlayPanel.setVisible(true);
-    }
-
     public static void main(String[] args) {
         try {
             UIManager.setLookAndFeel("javax.swing.plaf.nimbus.NimbusLookAndFeel");
-        } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException e) { // More specific catches
+        } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException e) {
             e.printStackTrace();
         }
         SwingUtilities.invokeLater(() -> {
Index: .idea/misc.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"ProjectRootManager\" version=\"2\" languageLevel=\"JDK_23\" default=\"true\" project-jdk-name=\"23\" project-jdk-type=\"JavaSDK\">\n    <output url=\"file://$PROJECT_DIR$/classes\" />\n  </component>\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/misc.xml b/.idea/misc.xml
--- a/.idea/misc.xml	(revision 9793dc6c8edd8e1d6bc907354e30a7993a07fe24)
+++ b/.idea/misc.xml	(date 1761488358558)
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <project version="4">
-  <component name="ProjectRootManager" version="2" languageLevel="JDK_23" default="true" project-jdk-name="23" project-jdk-type="JavaSDK">
+  <component name="ProjectRootManager" version="2" languageLevel="JDK_25" default="true" project-jdk-name="23" project-jdk-type="JavaSDK">
     <output url="file://$PROJECT_DIR$/classes" />
   </component>
 </project>
\ No newline at end of file
